    max-width: 250px;
  }

  .restaurant-callout h3 {
    margin: 0 0 0.5rem 0;
    font-size: 16px;
  }

  .restaurant-callout p {
    margin: 0.25rem 0;
    font-size: 14px;
    color: #ccc;
  }

  .restaurant-callout button {
    background: #750d0c;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 999px;
    margin-top: 0.5rem;
    cursor: pointer;
    width: 100%;
    transition: background-color 0.2s;
  }

  .restaurant-callout button:hover {
    background: #5a0a09;
  }

  /* Custom Mapbox styles */
  .mapboxgl-popup {
    max-width: none !important;
  }

  .mapboxgl-popup-content {
    background: #1f2a48;
    padding: 12px;
    border-radius: 8px;
    width: 280px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  }

  .restaurant-popup {
    width: 100%;
    position: relative;
    padding-right: 2.5rem;
  }

  .restaurant-popup__content {
    display: flex;
    gap: 12px;
    align-items: flex-start;
    margin-bottom: 8px;
  }

  .restaurant-popup__image-container {
    flex-shrink: 0;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    overflow: hidden;
  }

  .restaurant-popup__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .restaurant-popup__info {
    flex-grow: 1;
    min-width: 0;
  }

  .restaurant-popup h3 {
    margin: 0 0 4px 0;
    font-size: 14px;
    font-weight: 500;
    color: white;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .restaurant-popup p {
    margin: 2px 0;
    font-size: 12px;
    color: rgba(255, 255, 255, 0.7);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .restaurant-popup__details {
    margin: 6px 0;
    font-size: 12px;
  }

  .restaurant-popup__details p {
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .restaurant-popup .fa-star {
    font-size: 10px;
    color: #FFD700;
    margin-right: -2px;
  }

  .restaurant-popup__button {
    background: #750d0c;
    color: white;
    border: none;
    padding: 8px;
    border-radius: 4px;
    margin-top: 6px;
    cursor: pointer;
    width: 100%;
    font-size: 13px;
    font-weight: 500;
    transition: background-color 0.2s;
  }

  .restaurant-popup__button:hover {
    background: #5a0a09;
  }

  /* Custom Mapbox Controls */
  .mapboxgl-ctrl-group {
    background: #1f2a48;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 8px;
  }

  .mapboxgl-ctrl-group button {
    width: 40px;
    height: 40px;
    color: white !important;
  }

  /* Make the + and - signs white */
  .mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon,
  .mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon,
  .mapboxgl-ctrl-compass .mapboxgl-ctrl-icon {
    filter: invert(1) brightness(100);
  }

  /* Hide the compass control */
  .mapboxgl-ctrl-compass {
    display: none !important;
  }

  .mapboxgl-ctrl-group button:hover {
    background: rgba(255, 255, 255, 0.1);
  }

  /* Geocoder (Search) Styles */
  .mapboxgl-ctrl-geocoder {
    width: 100% !important;
    max-width: none !important;
    background: #1f2a48;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 8px;
  }

  .mapboxgl-ctrl-geocoder input {
    color: white;
    background: transparent;
  }

  .mapboxgl-ctrl-geocoder input::placeholder {
    color: rgba(255, 255, 255, 0.6);
  }

  .mapboxgl-ctrl-geocoder .suggestions {
    background: #1f2a48;
    border: 1px solid rgba(255, 255, 255, 0.2);
  }

  .mapboxgl-ctrl-geocoder .suggestions > li > a {
    color: white;
  }

  .mapboxgl-ctrl-geocoder .suggestions > .active > a,
  .mapboxgl-ctrl-geocoder .suggestions > li > a:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
  }

  /* Add styles for filters */
  .search-modal__filters {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
  }

  .search-modal__filter {
    background: transparent;
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 999px;
    color: white;
    padding: 0.75rem 1.25rem;
    min-width: 120px;
    cursor: pointer;
    transition: background-color 0.2s;
    font-size: 1rem;
  }

  .search-modal__filter:hover {
    background: rgba(255, 255, 255, 0.1);
  }

  .search-modal__filter option {
    background: #1f2a48;
    color: white;
    padding: 8px;
  }

  /* Style Mapbox Directions */
  .mapboxgl-ctrl-directions {
    background: #1f2a48 !important;
    color: white !important;
  }

  .mapbox-directions-component {
    background: #1f2a48 !important;
    color: white !important;
  }

  .mapbox-directions-inputs button {
    background-color: #1f2a48 !important;
    color: white !important;
  }

  .mapbox-directions-route-summary {
    color: white !important;
  }

  .mapbox-directions-instructions {
    color: white !important;
  }

  /* Update existing styles */
  .restaurant-popup {
    min-width: 250px;
  }

  .restaurant-popup__details {
    margin: 8px 0;
    padding: 8px 0;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  }

  .restaurant-popup__hours {
    font-size: 12px;
    color: #ccc;
    margin: 4px 0;
  }

  .restaurant-popup__actions {
    display: flex;
    gap: 8px;
    margin-top: 12px;
  }

  .restaurant-popup__button {
    flex: 1;
    background: #750d0c;
    color: white;
    border: none;
    padding: 8px;
    border-radius: 999px;
    cursor: pointer;
    transition: background-color 0.2s;
    font-size: 13px;
  }

  .restaurant-popup__button:hover {
    background: #5a0a09;
  }

  .restaurant-popup__button--outline {
    background: transparent;
    border: 1px solid #750d0c;
  }

  .restaurant-popup__button--outline:hover {
    background: rgba(117, 13, 12, 0.1);
  }

  /* Hide the directions control completely */
  .mapboxgl-ctrl-directions,
  .mapbox-directions-component,
  .mapbox-directions-inputs,
  .mapbox-directions-route-summary,
  .mapbox-directions-instructions {
    display: none !important;
  }

  /* Hide the mode buttons (Traffic, Driving, Walking, Cycling) */
  .mapbox-directions-profile {
    display: none !important;
  }

  /* Update popup styles */
  .restaurant-popup {
    min-width: 200px;
    padding: 4px;
  }

  .restaurant-popup h3 {
    margin: 0 0 4px 0;
    font-size: 14px;
    color: white;
  }

  .restaurant-popup p {
    margin: 2px 0;
    font-size: 12px;
    color: #ccc;
  }

  .restaurant-popup__details {
    margin: 4px 0;
    padding: 4px 0;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  }

  .restaurant-popup__button {
    background: #750d0c;
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 4px;
    margin-top: 8px;
    cursor: pointer;
    width: 100%;
    font-size: 12px;
    transition: background-color 0.2s;
  }

  .restaurant-popup__button:hover {
    background: #5a0a09;
  }

  .restaurant-popup .fa-star {
    font-size: 10px;
    color: #FFD700;
  }

  // ... existing code ...

  // Update the popup HTML template in both initializeMap and updateMapMarkers functions
  const popupTemplate = `
    <div class="restaurant-popup">
      <div class="restaurant-popup__content">
        <div class="restaurant-popup__image-container">
          <img src="{{ imageUrl }}" alt="{{ restaurant.name }}" class="restaurant-popup__image">
          </div>
        <div class="restaurant-popup__info">
          <h3>{{ restaurant.name }}</h3>
          <p>{{ restaurant.cuisine }}</p>
          <p>{{ restaurant.address }}</p>
        </div>
      </div>
      <div class="restaurant-popup__details">
        <p>Rating: {{ restaurant.rating }} <i class="fas fa-star"></i> • {{ restaurant.price }}</p>
      </div>
      <button class="restaurant-popup__button" onclick="bookRestaurant('{{ restaurant.name }}')">
        Book Now
      </button>
    </div>
  `;

  // Add the booking function
  function bookRestaurant(restaurantName) {
    // Show booking modal
    const bookingModal = document.getElementById('bookingModal');
    const modalOverlay = document.getElementById('modalOverlay');
    bookingModal.style.display = 'block';
    modalOverlay.style.display = 'block';
    document.body.style.overflow = 'hidden';
    
    // Update modal title with restaurant name
    const modalTitle = bookingModal.querySelector('.booking-modal__title');
    modalTitle.textContent = `Book {{ restaurant.name }}`;
  }

  // ... existing code ...

  /* Add bookmark button styles */
  .bookmark-button {
    position: absolute;
    top: 0.75rem;
    right: 0.75rem;
    background: rgba(31, 42, 72, 0.9);
    border: none;
    color: white;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    z-index: 1;
  }

  .bookmark-button:hover {
    background: rgba(31, 42, 72, 1);
    transform: scale(1.05);
  }

  .bookmark-button[data-favorited="true"] {
    color: #E31837;
  }

  .bookmark-tooltip {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(31, 42, 72, 0.9);
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    white-space: nowrap;
    opacity: 0;
    transition: opacity 0.2s;
    pointer-events: none;
  }

  .bookmark-button:hover .bookmark-tooltip {
    opacity: 1;
  }

  /* Update restaurant card to include bookmark */
  .restaurant-card {
    position: relative;
    /* ... existing code ... */
  }

  /* Update popup styles to accommodate bookmark */
  .restaurant-popup {
    position: relative;
    padding-right: 2.5rem;
  }

  // ... existing code ...

  /* Add favorites management */
  let userFavorites = [];
  let isAuthenticated = false;

  // Function to toggle favorite
  async function toggleFavorite(restaurantId, button) {
    if (!isAuthenticated) {
      document.querySelector('.login-modal').style.display = 'block';
      return;
    }

    const isFavorited = userFavorites.includes(restaurantId);
    
    // Optimistic UI update
    if (isFavorited) {
      userFavorites = userFavorites.filter(id => id !== restaurantId);
    } else {
      userFavorites.push(restaurantId);
    }
    
    // Update UI
    updateFavoriteButton(button, !isFavorited);
    
    try {
      // API call
      const response = await fetch(`/api/favorites/${isFavorited ? 'remove' : 'add'}`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ restaurantId }),
      });
      
      if (!response.ok) {
        throw new Error('Failed to update favorites');
      }
    } catch (error) {
      console.error('Error updating favorites:', error);
      // Revert optimistic update on error
      if (isFavorited) {
        userFavorites.push(restaurantId);
      } else {
        userFavorites = userFavorites.filter(id => id !== restaurantId);
      }
      updateFavoriteButton(button, isFavorited);
    }
  }

  // Function to update favorite button UI
  function updateFavoriteButton(button, isFavorited) {
    button.setAttribute('data-favorited', isFavorited);
    button.innerHTML = `
      <i class="fas fa-bookmark${isFavorited ? '' : '-regular'}"></i>
      <span class="bookmark-tooltip">${isFavorited ? 'Remove from favorites' : 'Save to favorites'}</span>
    `;
  }

  // Update restaurant card template
  function createRestaurantCard(restaurant) {
    const isFavorited = userFavorites.includes(restaurant.id);
    return `
      <div class="restaurant-card">
        <button 
          class="bookmark-button" 
          data-favorited="${isFavorited}"
          onclick="toggleFavorite('{{ restaurant.id }}', this)"
        >
          <i class="fas fa-bookmark${isFavorited ? '' : '-regular'}"></i>
          <span class="bookmark-tooltip">${isFavorited ? 'Remove from favorites' : 'Save to favorites'}</span>
        </button>
        <img class="restaurant-card__image" src="{{ restaurant.image }}" alt="{{ restaurant.name }}">
        <div class="restaurant-card__content">
          <!-- ... existing content ... -->
        </div>
      </div>
    `;
  }

  // Update popup HTML generation
  function getPopupHTML(restaurant) {
    const isFavorited = userFavorites.includes(restaurant.id);
    return `
      <div class="restaurant-popup">
        <button 
          class="bookmark-button" 
          data-favorited="${isFavorited}"
          onclick="toggleFavorite('{{ restaurant.id }}', this)"
        >
          <i class="fas fa-bookmark${isFavorited ? '' : '-regular'}"></i>
          <span class="bookmark-tooltip">${isFavorited ? 'Remove from favorites' : 'Save to favorites'}</span>
        </button>
        <img class="restaurant-popup__image" src="{{ restaurant.image }}" alt="{{ restaurant.name }}" loading="lazy">
        <div class="restaurant-popup__content">
          <h3>{{ restaurant.name }}</h3>
          <p>{{ restaurant.cuisine }}</p>
          <p>{{ restaurant.address }}</p>
          <div class="restaurant-popup__details">
            <span class="rating">
              {{ restaurant.rating }}
            </span>
            <span class="price">{{ restaurant.price }}</span>
          </div>
          <button class="restaurant-popup__button">Book Now</button>
        </div>
      </div>
    `;
  }

  // Initialize favorites when user logs in
  function initializeFavorites(favorites = []) {
    userFavorites = favorites;
    isAuthenticated = true;
    // Update all existing bookmark buttons
    document.querySelectorAll('.bookmark-button').forEach(button => {
      const restaurantId = button.closest('[data-restaurant-id]').dataset.restaurantId;
      updateFavoriteButton(button, userFavorites.includes(restaurantId));
    });
  }

  // ... existing code ...

  /* Update restaurant-popup__details styles */
  .restaurant-popup__details {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin: 8px 0;
  }

  .restaurant-popup__details .rating {
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .restaurant-popup__details .price {
    color: #ccc;
  }

  /* Update bookmark button styles for popup */
  .restaurant-popup .bookmark-button {
    position: static; /* Override absolute positioning */
    width: 24px;
    height: 24px;
    margin-left: 8px;
    background: transparent;
  }

  .restaurant-popup .bookmark-button:hover {
    transform: scale(1.1);
    background: transparent;
  }

  /* Update popup HTML generation function */
  function getPopupHTML(restaurant) {
    const isFavorited = userFavorites.includes(restaurant.id);
    return `
      <div class="restaurant-popup">
        <img class="restaurant-popup__image" src="{{ restaurant.image }}" alt="{{ restaurant.name }}" loading="lazy">
        <div class="restaurant-popup__content">
          <h3>{{ restaurant.name }}</h3>
          <p>{{ restaurant.cuisine }}</p>
          <p>{{ restaurant.address }}</p>
          <div class="popup-details-row">
            <div class="popup-rating">
              <i class="fas fa-star"></i>
              <span>{{ restaurant.rating }}</span>
          </div>
            <span class="popup-price">{{ restaurant.price }}</span>
            <button 
              class="popup-bookmark" 
              data-favorited="{{ isFavorited }}"
              onclick="toggleFavorite('{{ restaurant.id }}', this)"
              title="{% if isFavorited %}Remove from favorites{% else %}Save to favorites{% endif %}"
            >
              <i class="fa-{% if isFavorited %}solid{% else %}regular{% endif %} fa-bookmark"></i>
            </button>
          </div>
          <button class="restaurant-popup__button">Book Now</button>
        </div>
      </div>
    `;
  }

  /* Add styles for the popup details row */
  .popup-details-row {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 12px;
    margin: 8px 0;
  }

  .popup-rating {
    display: flex;
    align-items: center;
    gap: 4px;
    color: white;
  }

  .popup-rating .fa-star {
    color: #FFD700;
    font-size: 14px;
  }

  .popup-price {
    color: #ccc;
  }

  .popup-bookmark {
    margin-left: auto;
    background: transparent;
    border: none;
    padding: 0;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s;
  }

  .popup-bookmark:hover {
    transform: scale(1.1);
  }

  .popup-bookmark[data-favorited="true"] {
    color: #E31837;
  }

  .popup-bookmark .fa-bookmark,
  .popup-bookmark .fa-bookmark-regular {
    font-size: 16px;
  }

  /* Update the popup HTML generation function */
  function getPopupHTML(restaurant) {
    const isFavorited = userFavorites.includes(restaurant.id);
    return `
      <div class="restaurant-popup">
        <img class="restaurant-popup__image" src="{{ restaurant.image }}" alt="{{ restaurant.name }}" loading="lazy">
        <div class="restaurant-popup__content">
          <h3>{{ restaurant.name }}</h3>
          <p>{{ restaurant.cuisine }}</p>
          <p>{{ restaurant.address }}</p>
          <div class="popup-details-row">
            <div class="popup-rating">
              <i class="fas fa-star"></i>
              <span>{{ restaurant.rating }}</span>
          </div>
            <span class="popup-price">{{ restaurant.price }}</span>
            <button 
              class="popup-bookmark" 
              data-favorited="{{ isFavorited }}"
              onclick="toggleFavorite('{{ restaurant.id }}', this)"
              title="{% if isFavorited %}Remove from favorites{% else %}Save to favorites{% endif %}"
            >
              <i class="fa-{% if isFavorited %}solid{% else %}regular{% endif %} fa-bookmark"></i>
            </button>
          </div>
          <button class="restaurant-popup__button">Book Now</button>
        </div>
      </div>
    `;
  }

  /* First, create the BookmarkButton component styles */
  .bookmark-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    padding: 0;
    margin-left: 8px;
    cursor: pointer;
    transition: transform 0.2s;
  }

  .bookmark-button:hover {
    transform: scale(1.1);
  }

  .bookmark-button i {
    font-size: 20px;
  }

  .bookmark-button[data-favorited="true"] i {
    color: #E31837;
  }

  /* Update the popup details container styles */
  .popup-details {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin: 8px 0;
    width: 100%;
  }

  .popup-info {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .popup-rating {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 14px;
  }

  .popup-rating i {
    color: #FFD700;
  }

  .popup-price {
    color: #ccc;
    font-size: 14px;
  }

  /* Update the popup HTML generation function */
  function getPopupHTML(restaurant) {
    const isFavorited = userFavorites.includes(restaurant.id);
    return `
      <div class="restaurant-popup">
        <img class="restaurant-popup__image" src="{{ restaurant.image }}" alt="{{ restaurant.name }}" loading="lazy">
        <div class="restaurant-popup__content">
          <h3>{{ restaurant.name }}</h3>
          <p>{{ restaurant.cuisine }}</p>
          <p>{{ restaurant.address }}</p>
          <div class="popup-details">
            <div class="popup-info">
              <div class="popup-rating">
                <i class="fas fa-star"></i>
                <span>{{ restaurant.rating }}</span>
              </div>
              <span class="popup-price">{{ restaurant.price }}</span>
            </div>
            <button 
              class="bookmark-button" 
              data-favorited="{{ isFavorited }}"
              onclick="toggleFavorite('{{ restaurant.id }}', this)"
              aria-label="{% if isFavorited %}Remove from favorites{% else %}Add to favorites{% endif %}"
            >
              <i class="fa-{% if isFavorited %}solid{% else %}regular{% endif %} fa-bookmark"></i>
            </button>
          </div>
          <button class="restaurant-popup__button">Book Now</button>
        </div>
      </div>
    `;
  }

  /* Update popup details styles */
  .popup-details {
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 12px;
    margin: 8px 0;
    width: 100%;
  }

  .popup-rating {
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .popup-rating .fa-star {
    color: #FFD700;
    font-size: 14px;
  }

  .popup-rating span {
    color: white;
    font-size: 14px;
  }

  .popup-price {
    color: #ccc;
    font-size: 14px;
  }

  .popup-bookmark {
    margin-left: auto;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    padding: 0;
    cursor: pointer;
    color: white;
    transition: transform 0.2s;
  }

  .popup-bookmark:hover {
    transform: scale(1.1);
  }

  .popup-bookmark[data-favorited="true"] {
    color: #E31837;
  }

  .popup-bookmark i {
    font-size: 18px;
  }

  /* Update the popup HTML generation function */
  function getPopupHTML(restaurant) {
    const isFavorited = userFavorites.includes(restaurant.id);
    return `
      <div class="restaurant-popup">
        <img class="restaurant-popup__image" src="{{ restaurant.image }}" alt="{{ restaurant.name }}" loading="lazy">
        <div class="restaurant-popup__content">
          <h3>{{ restaurant.name }}</h3>
          <p>{{ restaurant.cuisine }}</p>
          <p>{{ restaurant.address }}</p>
          <div class="popup-details">
            <div class="popup-rating">
              <i class="fas fa-star"></i>
              <span>{{ restaurant.rating }}</span>
            </div>
            <span class="popup-price">{{ restaurant.price }}</span>
            <button 
              class="popup-bookmark" 
              data-favorited="{{ isFavorited }}"
              onclick="toggleFavorite('{{ restaurant.id }}', this)"
              aria-label="{% if isFavorited %}Remove from favorites{% else %}Add to favorites{% endif %}"
            >
              <i class="fa-{% if isFavorited %}solid{% else %}regular{% endif %} fa-bookmark"></i>
            </button>
          </div>
          <button class="restaurant-popup__button">Book Now</button>
        </div>
      </div>
    `;
  }

  /* Add styles for the map popup */
  .mapboxgl-popup-content {
    background: #1f2a48;
    color: white;
    border-radius: 8px;
    padding: 16px;
    min-width: 240px;
  }

  .mapboxgl-popup-close-button {
    color: white;
    font-size: 18px;
    padding: 5px 8px;
  }

  .popup-header {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    margin-bottom: 8px;
  }

  .popup-image {
    width: 48px;
    height: 48px;
    border-radius: 8px;
    object-fit: cover;
  }

  .popup-title {
    margin: 0;
    font-size: 16px;
    font-weight: 600;
  }

  .popup-subtitle {
    margin: 4px 0;
    font-size: 14px;
    color: #ccc;
  }

  .popup-details {
    display: flex;
    align-items: center;
    gap: 12px;
    margin: 12px 0;
  }

  .popup-rating {
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .popup-rating .fa-star {
    color: #FFD700;
    font-size: 14px;
  }

  .popup-rating span {
    color: white;
    font-size: 14px;
  }

  .popup-price {
    color: #ccc;
    font-size: 14px;
  }

  .popup-bookmark {
    margin-left: auto;
    background: transparent;
    border: none;
    padding: 0;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
  }

  .popup-bookmark:hover {
    transform: scale(1.1);
  }

  .popup-bookmark i {
    font-size: 18px;
  }

  .popup-bookmark[data-favorited="true"] i {
    color: #E31837;
  }

  .popup-book-button {
    width: 100%;
    background: #750d0c;
    color: white;
    border: none;
    border-radius: 999px;
    padding: 8px 16px;
    font-size: 14px;
    cursor: pointer;
    transition: background-color 0.2s;
  }

  .popup-book-button:hover {
    background: #8f100f;
  }

  /* Update the popup HTML generation function */
  function getPopupHTML(restaurant) {
    const isFavorited = userFavorites.includes(restaurant.id);
    return `
      <div class="popup-content">
        <div class="popup-header">
          <img class="popup-image" src="{{ restaurant.image }}" alt="{{ restaurant.name }}">
              <div>
            <h3 class="popup-title">{{ restaurant.name }}</h3>
            <p class="popup-subtitle">{{ restaurant.cuisine }}</p>
            <p class="popup-subtitle">{{ restaurant.address }}</p>
              </div>
      </div>
        <div class="popup-details">
          <div class="popup-rating">
            <i class="fas fa-star"></i>
            <span>{{ restaurant.rating }}</span>
          </div>
          <span class="popup-price">{{ restaurant.price }}</span>
          <button 
            class="popup-bookmark" 
            data-favorited="{{ isFavorited }}"
            onclick="toggleFavorite('{{ restaurant.id }}', this)"
            aria-label="{% if isFavorited %}Remove from favorites{% else %}Add to favorites{% endif %}"
          >
            <i class="fa-{% if isFavorited %}solid{% else %}regular{% endif %} fa-bookmark"></i>
          </button>
        </div>
        <button class="popup-book-button">Book Now</button>
      </div>
    `;
  }

  /* Update the map marker creation function */
  function createMarker(restaurant) {
    const marker = new mapboxgl.Marker({
      color: '#E31837'
    })
    .setLngLat(restaurant.coordinates)
    .setPopup(
      new mapboxgl.Popup({
        closeButton: true,
        closeOnClick: false,
        maxWidth: 'none',
        className: 'restaurant-popup'
      })
      .setHTML(getPopupHTML(restaurant))
    )
    .addTo(map);
    
    markers.push(marker);
  }

  /* Map popup styles */
  .mapboxgl-popup-content {
    background: #0E1B38;
    color: white;
    border-radius: 8px;
    padding: 16px;
    width: 288px; /* w-72 equivalent */
  }

  .venue-popup {
    color: white;
  }

  .venue-header {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
  }

  .venue-image {
    width: 40px;
    height: 40px;
    border-radius: 9999px;
    margin-right: 8px;
    object-fit: cover;
  }

  .venue-name {
    font-size: 18px;
    font-weight: 600;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .venue-description {
    font-size: 14px;
    color: #9CA3AF;
    margin-bottom: 4px;
  }

  .venue-address {
    font-size: 14px;
    color: #6B7280;
    margin-bottom: 8px;
  }

  .venue-details {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: 8px;
    margin-bottom: 16px;
  }

  .venue-meta {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .venue-rating, .venue-price {
    font-size: 14px;
    color: white;
  }

  .venue-rating i {
    color: #FFD700;
    margin-right: 2px;
  }

  .venue-bookmark {
    background: transparent;
    border: none;
    color: white;
    cursor: pointer;
    padding: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.2s;
  }

  .venue-bookmark:hover {
    transform: scale(1.1);
  }

  .venue-bookmark i {
    font-size: 20px;
  }

  .venue-bookmark[data-favorited="true"] i {
    color: #E31837;
  }

  .venue-book-button {
    width: 100%;
    background: #DC2626;
    color: white;
    padding: 8px 0;
    border: none;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
    transition: background-color 0.2s;
  }

  .venue-book-button:hover {
    background: #B91C1C;
  }

  /* Update the popup HTML generation function */
  function getPopupHTML(restaurant) {
    const isFavorited = userFavorites.includes(restaurant.id);
    return `
      <div class="venue-popup">
        <div class="venue-header">
          <img 
            src="{{ restaurant.image }}" 
            alt="{{ restaurant.name }}" 
            class="venue-image"
          />
          <h2 class="venue-name">{{ restaurant.name }}</h2>
        </div>
        
        <p class="venue-description">{{ restaurant.cuisine }}</p>
        <p class="venue-address">{{ restaurant.address }}</p>
        
        <div class="venue-details">
          <div class="venue-meta">
            <span class="venue-rating">
              <i class="fas fa-star"></i>
              {{ restaurant.rating }}
            </span>
            <span class="venue-price">{{ restaurant.price }}</span>
          </div>
          
          <!-- Bookmark Button -->
          <button 
            class="venue-bookmark" 
            data-favorited="{{ isFavorited }}"
            onclick="toggleFavorite('{{ restaurant.id }}', this)"
            aria-label="{% if isFavorited %}Remove from favorites{% else %}Add to favorites{% endif %}"
          >
            <i class="fa-{% if isFavorited %}solid{% else %}regular{% endif %} fa-bookmark"></i>
          </button>
        </div>
        
        <button class="venue-book-button">
          Book Now
        </button>
      </div>
    `;
  }

  /* Update cuisine carousel styles */
  .cuisine-section {
    padding: 1rem 0 1.5rem;
    background: #0B1C3F;
    color: white;
    will-change: transform;
    margin-bottom: 2rem;
  }

  .cuisine-section__content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
  }

  .cuisine-carousel {
    display: flex;
    gap: 20px;
    overflow-x: auto;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    padding: 0.5rem 0;
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    transform: translateZ(0);
  }

  .cuisine-carousel::-webkit-scrollbar {
    display: none;
  }

  .cuisine-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 64px;
    text-align: center;
    cursor: pointer;
    transition: transform 0.2s;
  }

  .cuisine-card:hover {
    transform: translateY(-2px);
  }

  .cuisine-card__image-container {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    overflow: hidden;
    margin-bottom: 6px;
  }

  .cuisine-card__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transform: translateZ(0); /* Force GPU acceleration */
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    loading: "lazy"; /* Lazy load images */
  }

  .cuisine-card__title {
    font-size: 12px;
    font-weight: 500;
    color: white;
    margin: 0;
    white-space: nowrap;
  }

  .cuisine-card__count {
    font-size: 12px;
    color: #9CA3AF;
    margin: 0;
  }

  /* Add preload hints for critical images */
  <link rel="preload" href="https://imgur.com/tR9r1lW.jpg" as="image">
  <link rel="preload" href="https://imgur.com/X05FKgP.jpg" as="image">
  <link rel="preload" href="https://imgur.com/NJX6ldy.jpg" as="image">

  <!-- Optimize image loading with srcset and lazy loading -->
  <!-- Georgian -->
  <div class="cuisine-card" onclick="filterByCuisine('Georgian')">
    <div class="cuisine-card__image-container">
      <img src="https://i.imgur.com/tR9r1lW.jpg" 
           loading="lazy"
           decoding="async"
           alt="Georgian" 
           class="cuisine-card__image">
    </div>
    <h3 class="cuisine-card__title">Georgian</h3>
  </div>

  <!-- Pizza -->
  <div class="cuisine-card" onclick="filterByCuisine('Pizza')">
    <div class="cuisine-card__image-container">
      <img src="https://i.imgur.com/X05FKgP.jpg"
           loading="lazy"
           decoding="async"
           alt="Pizza" 
           class="cuisine-card__image">
    </div>
    <h3 class="cuisine-card__title">Pizza</h3>
  </div>

  <!-- Add debounced scroll handler -->
  <script>
  function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
      const later = () => {
        clearTimeout(timeout);
        func(...args);
      };
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
    };
  }

  // Optimize scroll performance
  document.querySelector('.cuisine-carousel').addEventListener('wheel', debounce((e) => {
    const carousel = e.currentTarget;
    const isScrollable = carousel.scrollWidth > carousel.clientWidth;
    
    if (isScrollable) {
      const isAtLeftEdge = carousel.scrollLeft === 0 && e.deltaY < 0;
      const isAtRightEdge = carousel.scrollLeft >= carousel.scrollWidth - carousel.clientWidth && e.deltaY > 0;
      
      if (!isAtLeftEdge && !isAtRightEdge) {
        e.preventDefault();
        carousel.scrollLeft += e.deltaY;
      }
    }
  }, 16)); // Debounce to 60fps

  // Optimize cuisine filtering
  function filterByCuisine(cuisine) {
    requestAnimationFrame(() => {
      document.querySelectorAll('.cuisine-card').forEach(card => {
        card.classList.toggle('selected', card.querySelector('.cuisine-card__title').textContent === cuisine);
      });
      console.log(`Filtering by cuisine: ${cuisine}`);
    });
  }
  </script>

  <!-- Defer non-critical CSS -->
  <link rel="stylesheet" href="non-critical.css" media="print" onload="this.media='all'">

  <!-- Preconnect to image domain -->
  <link rel="preconnect" href="https://imgur.com">
  <link rel="dns-prefetch" href="https://imgur.com">

  /* Adjust trending section spacing */
  .restaurant-section {
    padding-top: 1rem;
  }

  .restaurant-section__title {
    margin-top: 0;
    margin-bottom: 1.5rem;
  }

  <style>
  body {
    background: #0B1C3F !important;
  }
  </style>

  <style>
  .wine-tasting-card__reserve {
    margin-top: 10px !important;
    background: #8B1111 !important;
    color: white !important;
    border: none !important;
    border-radius: 8px !important;
    padding: 6px 10px !important;
    font-size: 13px !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    transition: background 0.2s !important;
    display: flex !important;
    align-items: center !important;
    gap: 6px !important;
    min-width: 0 !important;
    width: 100%;
    justify-content: center;
  }
  .wine-tasting-card__content {
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    height: 120px;
  }
  .wine-tasting-card {
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    height: 260px;
    min-width: 240px;
    max-width: 240px;
    box-sizing: border-box;
  }
  .wine-tasting-card__title {
    min-height: 22px;
    display: flex;
    align-items: flex-end;
    margin-bottom: 6px;
    font-size: 16px;
    font-weight: 600;
    color: white;
  }
  .wine-tasting-card__image {
    width: 100%;
    height: 140px;
    object-fit: cover;
    flex-shrink: 0;
  }
</style>

<header class="header">
  <div class="header__content">
    <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
      <h1 class="header__greeting">Ready to book your table?</h1>
      <button class="mobile-menu-toggle" id="mobileMenuToggle">
        <i class="fas fa-bars"></i>
      </button>
              </div>
    
    <div class="header__row">
      <div class="booking-buttons">
        <button class="booking-button" id="bookingTrigger">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
          </svg>
          <span id="bookingLabel">2 • 7:00 PM Tonight</span>
        </button>

        <button class="booking-button" id="locationButton">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
          <span id="locationText">Tbilisi, Georgia</span>
        </button>

        <button class="booking-button" id="searchButton">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
          <span>Search Restaurants</span>
        </button>
      </div>

      <div class="header__actions">
        <img src="https://imgur.com/8s7t9g4.png" alt="Logo" style="height: 40px; margin-right: 16px;" />

      {%- if shop.customer_accounts_enabled -%}
          <a href="{{ routes.account_url }}" class="header__icon header__icon--account">
            {% render 'icon-account' %}
            <span class="visually-hidden">
              {%- if customer -%}
                {{ 'customer.account_fallback' | t }}
              {%- else -%}
                {{ 'customer.log_in' | t }}
              {%- endif -%}
          </span>
        </a>
      {%- endif -%}
      </div>
    </div>
  </div>

  {%- if settings.cart_type == 'notification' -%}
    {%- render 'cart-notification' -%}
            {%- endif -%}

  <!-- Booking Modal -->
  <div class="booking-modal__overlay" id="modalOverlay"></div>
  <div class="booking-modal" id="bookingModal">
    <h3 class="booking-modal__title">Party size</h3>
    <div class="booking-modal__party-sizes" id="partySizes"></div>
    
    <h3 class="booking-modal__title">Date and time</h3>
    <div class="booking-modal__datetime">
      <select class="booking-modal__select" id="dateSelect"></select>
      <select class="booking-modal__select" id="timeSelect">
        <option value="11:00">11:00</option>
        <option value="11:30">11:30</option>
        <option value="12:00">12:00</option>
        <option value="12:30">12:30</option>
        <option value="13:00">13:00</option>
        <option value="13:30">13:30</option>
        <option value="14:00">14:00</option>
        <option value="14:30">14:30</option>
        <option value="15:00">15:00</option>
        <option value="15:30">15:30</option>
        <option value="16:00">16:00</option>
        <option value="16:30">16:30</option>
        <option value="17:00">17:00</option>
        <option value="17:30">17:30</option>
        <option value="18:00">18:00</option>
        <option value="18:30">18:30</option>
        <option value="19:00" selected>19:00</option>
        <option value="19:30">19:30</option>
        <option value="20:00">20:00</option>
        <option value="20:30">20:30</option>
        <option value="21:00">21:00</option>
        <option value="21:30">21:30</option>
        <option value="22:00">22:00</option>
        <option value="22:30">22:30</option>
        <option value="23:00">23:00</option>
        <option value="23:30">23:30</option>
      </select>
          </div>
    
    <button class="booking-modal__done" id="bookingDone">Done</button>
    </div>
  </header>

<!-- Login Modal -->
<div class="login-modal" id="loginModal">
  <div class="login-modal__content">
    <button class="login-modal__close" id="loginModalClose">&times;</button>
    <h2 class="login-modal__title">Enter your phone number</h2>
    <p class="login-modal__subtitle">We'll need to verify it's you to continue.</p>

    <label class="login-modal__input-label">Name</label>
    <input type="text" id="loginName" placeholder="Your full name" class="login-modal__input" />

    <label class="login-modal__input-label">Phone number</label>
    <div class="login-modal__phone-group">
      <select id="countryCode" class="login-modal__country-code">
        <option value="+995" selected>🇬🇪 +995</option>
        <option value="+1">🇺🇸 +1</option>
        <option value="+44">🇬🇧 +44</option>
        <option value="+33">🇫🇷 +33</option>
        <option value="+49">🇩🇪 +49</option>
        <option value="+81">🇯🇵 +81</option>
        <option value="+61">🇦🇺 +61</option>
        <option value="+91">🇮🇳 +91</option>
        <option value="+7">🇷🇺 +7</option>
        <option value="+86">🇨🇳 +86</option>
        <option value="+34">🇪🇸 +34</option>
        <option value="+39">🇮🇹 +39</option>
        <option value="+972">🇮🇱 +972</option>
        <option value="+82">🇰🇷 +82</option>
        <option value="+47">🇳🇴 +47</option>
        <option value="+370">🇱🇹 +370</option>
        <option value="+994">🇦🇿 +994</option>
        <option value="+380">🇺🇦 +380</option>
        <option value="+374">🇦🇲 +374</option>
        <option value="+212">🇲🇦 +212</option>
        <option value="+31">🇳🇱 +31</option>
        <option value="+46">🇸🇪 +46</option>
        <option value="+45">🇩🇰 +45</option>
        <option value="+358">🇫🇮 +358</option>
        <option value="+48">🇵🇱 +48</option>
        <option value="+43">🇦🇹 +43</option>
        <option value="+36">🇭🇺 +36</option>
        <option value="+420">🇨🇿 +420</option>
        <option value="+30">🇬🇷 +30</option>
        <option value="+40">🇷🇴 +40</option>
        <option value="+359">🇧🇬 +359</option>
        <option value="+351">🇵🇹 +351</option>
        <option value="+353">🇮🇪 +353</option>
        <option value="+32">🇧🇪 +32</option>
        <option value="+41">🇨🇭 +41</option>
        <option value="+90">🇹🇷 +90</option>
        <option value="+20">🇪🇬 +20</option>
        <option value="+27">🇿🇦 +27</option>
        <option value="+55">🇧🇷 +55</option>
        <option value="+52">🇲🇽 +52</option>
        <option value="+54">🇦🇷 +54</option>
      </select>
      <input type="tel" id="loginPhone" placeholder="Phone number" class="login-modal__input" style="margin-bottom: 0;" />
    </div>

    <button id="loginSubmit" class="login-modal__submit">Continue</button>
    <a class="login-modal__email-link">Use email instead</a>

    <p class="login-modal__footer">
      By continuing, you agree to our <a href="#">Cookies policy</a> and <a href="#">Privacy policy</a>.
    </p>
  </div>
</div>

<!-- Add search modal -->
<div class="search-modal" id="searchModal">
  <div class="search-modal__content">
    <button class="search-modal__close" id="searchModalClose">&times;</button>
    <div class="search-modal__filters">
      <select id="cuisineFilter" class="search-modal__filter">
        <option value="">All Cuisines</option>
        <option value="Georgian">Georgian</option>
        <option value="European">European</option>
        <option value="French">French</option>
        <option value="Wine Bar">Wine Bar</option>
        <option value="Austrian">Austrian</option>
      </select>
      <select id="priceFilter" class="search-modal__filter">
        <option value="">All Prices</option>
        <option value="$">$</option>
        <option value="$$">$$</option>
        <option value="$$$">$$$</option>
        <option value="$$$$">$$$$</option>
      </select>
      <select id="ratingFilter" class="search-modal__filter">
        <option value="">All Ratings</option>
        <option value="4.8">4.8+</option>
        <option value="4.5">4.5+</option>
        <option value="4.0">4.0+</option>
        <option value="3.5">3.5+</option>
        <option value="3.0">3.0+</option>
      </select>
      <select id="distanceFilter" class="search-modal__filter">
        <option value="">Any Distance</option>
        <option value="2">Within 2 km</option>
        <option value="5">Within 5 km</option>
        <option value="7">Within 7 km</option>
        <option value="10">Within 10 km</option>
      </select>
    </div>
    <div class="search-modal__map-container">
      <div id="searchMap" class="search-modal__map"></div>
    </div>
  </div>
</div>

<!-- Static sample restaurant cards for visual testing -->
<section class="restaurant-section">
  <div class="restaurant-section__content">
    <h2 class="restaurant-section__title">Available now</h2>
    <div class="restaurant-carousel">
      <!-- Restaurant Card 1 -->
      <div class="restaurant-card">
        <img src="https://i.imgur.com/rII6OSp.png" alt="Honoré" class="restaurant-card__image">
        <div class="restaurant-card__content">
          <h3 class="restaurant-card__title">Honoré</h3>
          <p class="restaurant-card__meta">$$$ • Georgian • European • Barbecue • <i class="fas fa-star"></i> 4.8</p>
          <div class="restaurant-card__slots">
            <button class="time-slot">5:45 PM</button>
            <button class="time-slot">6:00 PM</button>
            <button class="time-slot">6:15 PM</button>
          </div>
        </div>
      </div>
      <!-- Restaurant Card 2 -->
      <div class="restaurant-card">
        <img src="https://i.imgur.com/3MmiwHU.png" alt="Lolita Bar Interior" class="restaurant-card__image">
        <div class="restaurant-card__content">
          <h3 class="restaurant-card__title">Lolita</h3>
          <p class="restaurant-card__meta">$$ • New American • Italian-Inspired • Cocktail Bar • <i class="fas fa-star"></i> 4.7</p>
          <div class="restaurant-card__slots">
            <button class="time-slot">5:30 PM</button>
            <button class="time-slot">6:30 PM</button>
            <button class="time-slot">7:00 PM</button>
          </div>
        </div>
      </div>
      <!-- Restaurant Card 3 -->
      <div class="restaurant-card">
        <img src="https://i.imgur.com/0vnzZ6R.png" alt="Rooms Tbilisi" class="restaurant-card__image">
        <div class="restaurant-card__content">
          <h3 class="restaurant-card__title">Rooms Tbilisi</h3>
          <p class="restaurant-card__meta">$$$ • Modern American • New Nordic • Farm-to-Table • <i class="fas fa-star"></i> 4.9</p>
          <div class="restaurant-card__slots">
            <button class="time-slot">6:00 PM</button>
            <button class="time-slot">6:45 PM</button>
            <button class="time-slot">7:15 PM</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End static sample block -->

<!-- Cuisine Categories Section -->
<section class="cuisine-section">
  <div class="cuisine-section__content">
    <div class="cuisine-carousel">
      <!-- Georgian -->
      <div class="cuisine-card" onclick="filterByCuisine('Georgian')">
        <div class="cuisine-card__image-container">
          <img src="https://i.imgur.com/tR9r1lW.jpg" alt="Georgian" class="cuisine-card__image">
        </div>
        <h3 class="cuisine-card__title">Georgian</h3>
      </div>

      <!-- Pizza -->
      <div class="cuisine-card" onclick="filterByCuisine('Pizza')">
        <div class="cuisine-card__image-container">
          <img src="https://i.imgur.com/X05FKgP.jpg" alt="Pizza" class="cuisine-card__image">
        </div>
        <h3 class="cuisine-card__title">Pizza</h3>
      </div>

      <!-- Sushi -->
      <div class="cuisine-card" onclick="filterByCuisine('Sushi')">
        <div class="cuisine-card__image-container">
          <img src="https://i.imgur.com/NJX6ldy.jpg" alt="Sushi" class="cuisine-card__image">
        </div>
        <h3 class="cuisine-card__title">Sushi</h3>
      </div>

      <!-- Italian -->
      <div class="cuisine-card" onclick="filterByCuisine('Italian')">
        <div class="cuisine-card__image-container">
          <img src="https://i.imgur.com/v00y30w.jpg" alt="Italian" class="cuisine-card__image">
        </div>
        <h3 class="cuisine-card__title">Italian</h3>
      </div>

      <!-- Wine Bar -->
      <div class="cuisine-card" onclick="filterByCuisine('Wine Bar')">
        <div class="cuisine-card__image-container">
          <img src="https://i.imgur.com/ZxCHmpz.jpg" alt="Wine Bar" class="cuisine-card__image">
        </div>
        <h3 class="cuisine-card__title">Wine Bar</h3>
      </div>

      <!-- European -->
      <div class="cuisine-card" onclick="filterByCuisine('European')">
        <div class="cuisine-card__image-container">
          <img src="https://i.imgur.com/cNEh111.jpg" alt="European" class="cuisine-card__image">
        </div>
        <h3 class="cuisine-card__title">European</h3>
      </div>

      <!-- Bar/Lounge -->
      <div class="cuisine-card" onclick="filterByCuisine('Bar/Lounge')">
        <div class="cuisine-card__image-container">
          <img src="https://i.imgur.com/eQDARHA.jpg" alt="Bar/Lounge" class="cuisine-card__image">
        </div>
        <h3 class="cuisine-card__title">Bar/Lounge</h3>
      </div>

      <!-- Bakery -->
      <div class="cuisine-card" onclick="filterByCuisine('Bakery')">
        <div class="cuisine-card__image-container">
          <img src="https://i.imgur.com/D40e1v6.jpg" alt="Bakery" class="cuisine-card__image">
        </div>
        <h3 class="cuisine-card__title">Bakery</h3>
      </div>

      <!-- Fine Dining -->
      <div class="cuisine-card" onclick="filterByCuisine('Fine Dining')">
        <div class="cuisine-card__image-container">
          <img src="https://i.imgur.com/RIcnsPk.jpg" alt="Fine Dining" class="cuisine-card__image">
        </div>
        <h3 class="cuisine-card__title">Fine Dining</h3>
      </div>

      <!-- Brunch Spot -->
      <div class="cuisine-card" onclick="filterByCuisine('Brunch Spot')">
        <div class="cuisine-card__image-container">
          <img src="https://i.imgur.com/pE2GUrU.jpg" alt="Brunch Spot" class="cuisine-card__image">
        </div>
        <h3 class="cuisine-card__title">Brunch Spot</h3>
      </div>

      <!-- Asian -->
      <div class="cuisine-card" onclick="filterByCuisine('Asian')">
        <div class="cuisine-card__image-container">
          <img src="https://i.imgur.com/c9gLXSF.jpg" alt="Asian" class="cuisine-card__image">
        </div>
        <h3 class="cuisine-card__title">Asian</h3>
      </div>

      <!-- Mediterranean -->
      <div class="cuisine-card" onclick="filterByCuisine('Mediterranean')">
        <div class="cuisine-card__image-container">
          <img src="https://i.imgur.com/2lgJh6w.jpg" alt="Mediterranean" class="cuisine-card__image">
        </div>
        <h3 class="cuisine-card__title">Mediterranean</h3>
      </div>

      <!-- Seafood -->
      <div class="cuisine-card" onclick="filterByCuisine('Seafood')">
        <div class="cuisine-card__image-container">
          <img src="https://i.imgur.com/meK7DUB.jpg" alt="Seafood" class="cuisine-card__image">
        </div>
        <h3 class="cuisine-card__title">Seafood</h3>
      </div>

      <!-- Vegetarian -->
      <div class="cuisine-card" onclick="filterByCuisine('Vegetarian')">
        <div class="cuisine-card__image-container">
          <img src="https://i.imgur.com/EPJuDmk.jpg" alt="Vegetarian" class="cuisine-card__image">
        </div>
        <h3 class="cuisine-card__title">Vegetarian</h3>
      </div>
    </div>
  </div>
</section>

<!-- Trending Section -->
<section class="restaurant-section" style="padding-top: 0; margin-top: -2rem; border-top: none;">
  <div class="restaurant-section__content">
    <h2 class="restaurant-section__title">See what's trending with our weekly lists</h2>
    <div class="trending-list">
      <!-- Restaurant 1 -->
      <div class="trending-item">
        <img src="https://i.imgur.com/W5x0iFf.png" alt="Alubali" class="trending-item__image">
        <div class="trending-item__content">
          <h3 class="trending-item__title">Alubali</h3>
          <p class="trending-item__location">Tbilisi</p>
          <p class="trending-item__cuisine">Authentic Georgian</p>
          <div class="trending-item__rating">
            <div class="trending-item__stars">
              <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
            </div>
            <span class="trending-item__reviews">(70 Reviews)</span>
          </div>
        </div>
        <div class="trending-item__right">
          <button class="trending-item__save">
            <i class="far fa-bookmark"></i>
          </button>
          <div class="trending-item__distance">
            <i class="fas fa-map-marker-alt"></i>
            <span>2.3 km</span>
          </div>
          <span class="trending-item__price">$$$$</span>
        </div>
      </div>

      <!-- Restaurant 2 -->
      <div class="trending-item">
        <img src="https://i.imgur.com/iycCzV0.png" alt="Orangery" class="trending-item__image">
        <div class="trending-item__content">
          <h3 class="trending-item__title">Orangery</h3>
          <p class="trending-item__location">Tbilisi</p>
          <p class="trending-item__cuisine">Georgian & European</p>
          <div class="trending-item__rating">
            <div class="trending-item__stars">
              <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i>
            </div>
            <span class="trending-item__reviews">(45 Reviews)</span>
          </div>
        </div>
        <div class="trending-item__right">
          <button class="trending-item__save">
            <i class="far fa-bookmark"></i>
          </button>
          <div class="trending-item__distance">
            <i class="fas fa-map-marker-alt"></i>
            <span>800 m</span>
          </div>
          <span class="trending-item__price">$$</span>
        </div>
      </div>

      <!-- Restaurant 3 -->
      <div class="trending-item">
        <img src="https://i.imgur.com/ZK08ntt.png" alt="Coffee Shop Company" class="trending-item__image">
        <div class="trending-item__content">
          <h3 class="trending-item__title">Coffee Shop Company</h3>
          <p class="trending-item__location">Tbilisi</p>
          <p class="trending-item__cuisine">Austrian & Eastern European</p>
          <div class="trending-item__rating">
            <div class="trending-item__stars">
              <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i><i class="far fa-star"></i>
            </div>
            <span class="trending-item__reviews">(12 Reviews)</span>
          </div>
        </div>
        <div class="trending-item__right">
          <button class="trending-item__save">
            <i class="far fa-bookmark"></i>
          </button>
          <div class="trending-item__distance">
            <i class="fas fa-map-marker-alt"></i>
            <span>1.5 km</span>
          </div>
          <span class="trending-item__price">$$$</span>
        </div>
      </div>

      <!-- Restaurant 4 -->
      <div class="trending-item">
        <img src="https://i.imgur.com/npKcyus.png" alt="Paul" class="trending-item__image">
        <div class="trending-item__content">
          <h3 class="trending-item__title">Paul</h3>
          <p class="trending-item__location">Tbilisi</p>
          <p class="trending-item__cuisine">French Inspired</p>
          <div class="trending-item__rating">
            <div class="trending-item__stars">
              <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
            </div>
            <span class="trending-item__reviews">(59 Reviews)</span>
          </div>
        </div>
        <div class="trending-item__right">
          <button class="trending-item__save">
            <i class="far fa-bookmark"></i>
          </button>
          <div class="trending-item__distance">
            <i class="fas fa-map-marker-alt"></i>
            <span>3.2 km</span>
          </div>
          <span class="trending-item__price">$$$$</span>
        </div>
      </div>

      <!-- Restaurant 5 -->
      <div class="trending-item">
        <img src="https://i.imgur.com/ffNFiWL.png" alt="Strada" class="trending-item__image">
        <div class="trending-item__content">
          <h3 class="trending-item__title">Strada</h3>
          <p class="trending-item__location">Tbilisi</p>
          <p class="trending-item__cuisine">Contemporary American & Asian</p>
          <div class="trending-item__rating">
            <div class="trending-item__stars">
              <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i>
            </div>
            <span class="trending-item__reviews">(38 Reviews)</span>
          </div>
        </div>
        <div class="trending-item__right">
          <button class="trending-item__save">
            <i class="far fa-bookmark"></i>
          </button>
          <div class="trending-item__distance">
            <i class="fas fa-map-marker-alt"></i>
            <span>4.7 km</span>
          </div>
          <span class="trending-item__price">$$$</span>
        </div>
      </div>

      <!-- Restaurant 6 -->
      <div class="trending-item">
        <img src="https://i.imgur.com/nhIwbAE.png" alt="8000 Vintages" class="trending-item__image">
        <div class="trending-item__content">
          <h3 class="trending-item__title">8000 Vintages</h3>
          <p class="trending-item__location">Tbilisi</p>
          <p class="trending-item__cuisine">Wine Bar & Gourmet Bords</p>
          <div class="trending-item__rating">
            <div class="trending-item__stars">
              <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
            </div>
            <span class="trending-item__reviews">(82 Reviews)</span>
          </div>
        </div>
        <div class="trending-item__right">
          <button class="trending-item__save">
            <i class="far fa-bookmark"></i>
          </button>
          <div class="trending-item__distance">
            <i class="fas fa-map-marker-alt"></i>
            <span>650 m</span>
          </div>
          <span class="trending-item__price">$$</span>
        </div>
      </div>

      <!-- Restaurant 7 -->
      <div class="trending-item">
        <img src="https://i.imgur.com/A2XSgKc.png" alt="Canape" class="trending-item__image">
        <div class="trending-item__content">
          <h3 class="trending-item__title">Canape</h3>
          <p class="trending-item__location">Tbilisi</p>
          <p class="trending-item__cuisine">Georgian & European</p>
          <div class="trending-item__rating">
            <div class="trending-item__stars">
              <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
            </div>
            <span class="trending-item__reviews">(59 Reviews)</span>
          </div>
        </div>
        <div class="trending-item__right">
          <button class="trending-item__save">
            <i class="far fa-bookmark"></i>
          </button>
          <div class="trending-item__distance">
            <i class="fas fa-map-marker-alt"></i>
            <span>3.2 km</span>
          </div>
          <span class="trending-item__price">$$$$</span>
        </div>
      </div>

      <!-- Restaurant 8 -->
      <div class="trending-item">
        <img src="https://i.imgur.com/vKzlLfm.png" alt="Khedi" class="trending-item__image">
        <div class="trending-item__content">
          <h3 class="trending-item__title">Khedi</h3>
          <p class="trending-item__location">Tbilisi</p>
          <p class="trending-item__cuisine">Georgian & European</p>
          <div class="trending-item__rating">
            <div class="trending-item__stars">
              <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
            </div>
            <span class="trending-item__reviews">(59 Reviews)</span>
          </div>
        </div>
        <div class="trending-item__right">
          <button class="trending-item__save">
            <i class="far fa-bookmark"></i>
          </button>
          <div class="trending-item__distance">
            <i class="fas fa-map-marker-alt"></i>
            <span>3.2 km</span>
          </div>
          <span class="trending-item__price">$$$$</span>
        </div>
      </div>

      <!-- Restaurant 9 -->
      <div class="trending-item">
        <img src="https://i.imgur.com/JNsWf7e.png" alt="Tsiskvili" class="trending-item__image">
        <div class="trending-item__content">
          <h3 class="trending-item__title">Tsiskvili</h3>
          <p class="trending-item__location">Tbilisi</p>
          <p class="trending-item__cuisine">Authentic Georgian</p>
          <div class="trending-item__rating">
            <div class="trending-item__stars">
              <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
            </div>
            <span class="trending-item__reviews">(59 Reviews)</span>
          </div>
        </div>
        <div class="trending-item__right">
          <button class="trending-item__save">
            <i class="far fa-bookmark"></i>
          </button>
          <div class="trending-item__distance">
            <i class="fas fa-map-marker-alt"></i>
            <span>3.2 km</span>
          </div>
          <span class="trending-item__price">$$$$</span>
        </div>
      </div>

      <!-- Restaurant 10 -->
      <div class="trending-item">
        <img src="https://i.imgur.com/Z4Mjh6u.png" alt="Rigi" class="trending-item__image">
        <div class="trending-item__content">
          <h3 class="trending-item__title">Rigi</h3>
          <p class="trending-item__location">Tbilisi</p>
          <p class="trending-item__cuisine">Old Georgian Gastronomic Douqan</p>
          <div class="trending-item__rating">
            <div class="trending-item__stars">
              <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
            </div>
            <span class="trending-item__reviews">(59 Reviews)</span>
          </div>
        </div>
        <div class="trending-item__right">
          <button class="trending-item__save">
            <i class="far fa-bookmark"></i>
          </button>
          <div class="trending-item__distance">
            <i class="fas fa-map-marker-alt"></i>
            <span>3.2 km</span>
          </div>
          <span class="trending-item__price">$$$$</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Wine Tasting Section -->
<section class="wine-tasting-section" style="background: #0B1C3F; padding: 2rem 1rem;">
  <div class="wine-tasting-section__content" style="max-width: 1200px; margin: 0 auto;">
    <h2 class="wine-tasting-section__title" style="color: white; font-size: 18px; font-weight: 600; margin-bottom: 1rem;">Wine tasting</h2>
    <div class="wine-tasting-carousel" style="display: flex; gap: 16px; overflow-x: auto; padding-bottom: 1rem; -webkit-overflow-scrolling: touch; scrollbar-width: none;">
      <!-- Card 1 -->
      <div class="wine-tasting-card" style="min-width: 240px; background: #1f2a48; border-radius: 16px; overflow: hidden; cursor: pointer; transition: transform 0.2s; position: relative;">
        <img src="https://imgur.com/nhIwbAE.png" alt="8000 Vintages" class="wine-tasting-card__image" style="width: 100%; height: 140px; object-fit: cover;">
        <div class="wine-tasting-card__content" style="padding: 1rem;">
          <h3 class="wine-tasting-card__title" style="margin: 0 0 6px; font-size: 16px; font-weight: 600; color: white;">8000 Vintages</h3>
          <p class="wine-tasting-card__meta" style="margin: 0; font-size: 14px; color: #ccc;">Wine Bar • Gourmet Boards • <i class="fas fa-star"></i> 4.9</p>
          <button class="wine-tasting-card__reserve" style="margin-top: 12px; background: #DC2626; color: white; border: none; border-radius: 8px; padding: 10px 16px; font-size: 15px; font-weight: 600; cursor: pointer; transition: background 0.2s; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-wine-glass-alt"></i> Reserve a Tasting!
          </button>
        </div>
      </div>
      <!-- Card 2 -->
      <div class="wine-tasting-card" style="min-width: 240px; background: #1f2a48; border-radius: 16px; overflow: hidden; cursor: pointer; transition: transform 0.2s; position: relative;">
        <img src="https://imgur.com/A2XSgKc.png" alt="Canape" class="wine-tasting-card__image" style="width: 100%; height: 140px; object-fit: cover;">
        <div class="wine-tasting-card__content" style="padding: 1rem;">
          <h3 class="wine-tasting-card__title" style="margin: 0 0 6px; font-size: 16px; font-weight: 600; color: white;">Canape</h3>
          <p class="wine-tasting-card__meta" style="margin: 0; font-size: 14px; color: #ccc;">Georgian & European • <i class="fas fa-star"></i> 4.8</p>
          <button class="wine-tasting-card__reserve" style="margin-top: 12px; background: #DC2626; color: white; border: none; border-radius: 8px; padding: 10px 16px; font-size: 15px; font-weight: 600; cursor: pointer; transition: background 0.2s; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-wine-glass-alt"></i> Reserve a Tasting!
          </button>
        </div>
      </div>
      <!-- Card 3 -->
      <div class="wine-tasting-card" style="min-width: 240px; background: #1f2a48; border-radius: 16px; overflow: hidden; cursor: pointer; transition: transform 0.2s; position: relative;">
        <img src="https://imgur.com/iycCzV0.png" alt="Orangery" class="wine-tasting-card__image" style="width: 100%; height: 140px; object-fit: cover;">
        <div class="wine-tasting-card__content" style="padding: 1rem;">
          <h3 class="wine-tasting-card__title" style="margin: 0 0 6px; font-size: 16px; font-weight: 600; color: white;">Orangery</h3>
          <p class="wine-tasting-card__meta" style="margin: 0; font-size: 14px; color: #ccc;">Georgian & European • <i class="fas fa-star"></i> 4.7</p>
          <button class="wine-tasting-card__reserve" style="margin-top: 12px; background: #DC2626; color: white; border: none; border-radius: 8px; padding: 10px 16px; font-size: 15px; font-weight: 600; cursor: pointer; transition: background 0.2s; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-wine-glass-alt"></i> Reserve a Tasting!
          </button>
        </div>
      </div>
      <!-- Card 4 -->
      <div class="wine-tasting-card" style="min-width: 240px; background: #1f2a48; border-radius: 16px; overflow: hidden; cursor: pointer; transition: transform 0.2s; position: relative;">
        <img src="https://imgur.com/JNsWf7e.png" alt="Tsiskvili" class="wine-tasting-card__image" style="width: 100%; height: 140px; object-fit: cover;">
        <div class="wine-tasting-card__content" style="padding: 1rem;">
          <h3 class="wine-tasting-card__title" style="margin: 0 0 6px; font-size: 16px; font-weight: 600; color: white;">Tsiskvili</h3>
          <p class="wine-tasting-card__meta" style="margin: 0; font-size: 14px; color: #ccc;">Authentic Georgian • <i class="fas fa-star"></i> 4.8</p>
          <button class="wine-tasting-card__reserve" style="margin-top: 12px; background: #DC2626; color: white; border: none; border-radius: 8px; padding: 10px 16px; font-size: 15px; font-weight: 600; cursor: pointer; transition: background 0.2s; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-wine-glass-alt"></i> Reserve a Tasting!
          </button>
        </div>
      </div>
      <!-- Card 5 -->
      <div class="wine-tasting-card" style="min-width: 240px; background: #1f2a48; border-radius: 16px; overflow: hidden; cursor: pointer; transition: transform 0.2s; position: relative;">
        <img src="https://imgur.com/Z4Mjh6u.png" alt="Rigi" class="wine-tasting-card__image" style="width: 100%; height: 140px; object-fit: cover;">
        <div class="wine-tasting-card__content" style="padding: 1rem;">
          <h3 class="wine-tasting-card__title" style="margin: 0 0 6px; font-size: 16px; font-weight: 600; color: white;">Rigi</h3>
          <p class="wine-tasting-card__meta" style="margin: 0; font-size: 14px; color: #ccc;">Old Georgian Gastronomic Douqan • <i class="fas fa-star"></i> 4.8</p>
          <button class="wine-tasting-card__reserve" style="margin-top: 12px; background: #DC2626; color: white; border: none; border-radius: 8px; padding: 10px 16px; font-size: 15px; font-weight: 600; cursor: pointer; transition: background 0.2s; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-wine-glass-alt"></i> Reserve a Tasting!
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Restaurant Detail Modal -->
<div id="restaurantDetail" class="restaurant-detail">
  <div class="restaurant-detail__content" style="padding: 0; max-width: 768px; margin: auto;">
    <button onclick="closeRestaurantDetails()" class="restaurant-detail__close" style="z-index: 10; top: 1rem; right: 1rem; background: rgba(0,0,0,0.4); border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center;">&times;</button>
    
      <div class="honore-slider-container" style="position: relative; width: calc(100% - 3rem); margin: 1.5rem auto 0; border-radius: 16px; overflow: hidden; height: 350px; background: #333;">
        <div class="honore-slider-wrapper" style="display: flex; transition: transform 0.5s ease-in-out; height: 100%;">
          <img src="https://i.postimg.cc/hvMRSkkC/temp-Imagek1-Fc5-E.avif" class="honore-slide" style="width:100%; height: 100%; object-fit: cover; flex-shrink: 0;">
          <img src="https://i.postimg.cc/Lsfdqgdg/temp-Image6ssyvx.avif" class="honore-slide" style="width:100%; height: 100%; object-fit: cover; flex-shrink: 0;">
          <img src="https://i.postimg.cc/d1mz6MVq/temp-Image7-P8fb-T.avif" class="honore-slide" style="width:100%; height: 100%; object-fit: cover; flex-shrink: 0;">
          <img src="https://i.postimg.cc/zG4ZXSQ1/temp-Image-GLett7.avif" class="honore-slide" style="width:100%; height: 100%; object-fit: cover; flex-shrink: 0;">
          <img src="https://i.postimg.cc/NjKvcPp4/temp-Imagem-LNH2e.avif" class="honore-slide" style="width:100%; height: 100%; object-fit: cover; flex-shrink: 0;">
          <img src="https://i.postimg.cc/Y9w5Q2kn/temp-Image-P1-T8-Ih.avif" class="honore-slide" style="width:100%; height: 100%; object-fit: cover; flex-shrink: 0;">
          <img src="https://i.postimg.cc/NffwN0XZ/temp-Image-Wb-YAf-A.avif" class="honore-slide" style="width:100%; height: 100%; object-fit: cover; flex-shrink: 0;">
          <img src="https://i.postimg.cc/hPyRNqbv/temp-Image-Yy-Un-Qk.avif" class="honore-slide" style="width:100%; height: 100%; object-fit: cover; flex-shrink: 0;">
        </div>
        <button class="honore-slider-btn honore-prev" style="position: absolute; top: 50%; left: 10px; transform: translateY(-50%); background: rgba(0,0,0,0.5); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 24px; z-index:1;">&#10094;</button>
        <button class="honore-slider-btn honore-next" style="position: absolute; top: 50%; right: 10px; transform: translateY(-50%); background: rgba(0,0,0,0.5); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 24px; z-index:1;">&#10095;</button>
      </div>
      
      <div class="restaurant-detail__info-new" style="padding: 1rem 1.5rem;">
        <h2 style="font-size: 2rem; font-weight: 600; margin: 0 0 0.75rem;">Honoré</h2>
        <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem; color: #ccc; cursor: pointer;" id="reviewsTabTrigger">
          <span style="color: #750d0c;">
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
            <i class="fas fa-star"></i>
            <i class="fas fa-star-half-alt"></i>
          </span>
          <i class="far fa-comment-alt"></i>
          <span>4.8 (215 Reviews)</span>
        </div>
        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1rem; color: #ccc;">
            <i class="fas fa-money-bill-alt" style="width: 20px; text-align: center;"></i>
            <span>$$$</span>
            <span style="margin: 0 0.25rem;">•</span>
            <i class="fas fa-utensils" style="width: 20px; text-align: center;"></i>
            <span>Georgian & European</span>
        </div>
        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 1.5rem; color: #ccc;">
          <i class="fas fa-map-marker-alt" style="width: 20px; text-align: center;"></i>
          <span>4 Constitution street, Tbilisi 0112</span>
        </div>

        <button class="booking-button" id="restaurantBookingTrigger" style="width: 100%; justify-content: center;">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="width: 20px; height: 20px;">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
          </svg>
          <span id="restaurantBookingLabel">2 • 7:00 PM Tonight</span>
        </button>
      </div>

    <div class="restaurant-detail__menu" style="padding: 0 1.5rem 1.5rem;">
      <h3 style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1.5rem;">Menu</h3>
      <div class="menu-items" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">

        <!-- Hot smoked salmon on twigs -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/SRXF8CrW/temp-Image-Dsgb1-Q.avif" alt="Hot smoked salmon on twigs" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Hot smoked salmon on twigs</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">ორაგული წალამზე ცხლად შებოლილი</p>
            <p style="margin: 8px 0 0; font-weight: 600;">45.00 GEL</p>
          </div>
        </div>

        <!-- Chicken liver with plums -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/QNnSnR8N/temp-Image00-Zx-Os.avif" alt="Chicken liver with plums" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Chicken liver with plums</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">ქათმის ღვიძლი ქლიავთან ერთად</p>
            <p style="margin: 8px 0 0; font-weight: 600;">26 GEL</p>
          </div>
        </div>

        <!-- Burger -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/GtLtygWN/temp-Image-Mno-IMs.avif" alt="Burger" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Burger</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">ბურგერი</p>
            <p style="margin: 8px 0 0; font-weight: 600;">26 GEL</p>
          </div>
        </div>

        <!-- Grilled Veggies -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/TwHFVpF6/temp-Image-HT9-Kz6.avif" alt="Grilled Veggies" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Grilled Veggies</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">გრილზე შემწვარი ბოსტენული</p>
            <p style="margin: 8px 0 0; font-weight: 600;">19 GEL</p>
          </div>
        </div>

        <!-- Arugula salad -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/0j0ttjHj/temp-Image-Ec-Hk5-X.avif" alt="Arugula salad" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Arugula salad</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">რუკოლას სალათი</p>
            <p style="margin: 8px 0 0; font-weight: 600;">17 GEL</p>
          </div>
        </div>

        <!-- Dolma with Vine leaf -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/brSykX6m/temp-Imagego-Gfp-R.avif" alt="Dolma with Vine leaf" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Dolma with Vine leaf</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">ტოლმა ვაზის ფოთოლით</p>
            <p style="margin: 8px 0 0; font-weight: 600;">22 GEL</p>
          </div>
        </div>

        <!-- Pork tenderloin barbecue -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/X7XHKjkj/temp-Image6-AYPRx.avif" alt="Pork tenderloin barbecue" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Pork tenderloin barbecue</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">სუკის მწვადი</p>
            <p style="margin: 8px 0 0; font-weight: 600;">25 GEL</p>
          </div>
        </div>

        <!-- Greens Plate -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/cJWBz0w8/temp-Image09-Ad-Wz.avif" alt="Greens Plate" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Greens Plate</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">მწვანილის თეფში</p>
            <p style="margin: 8px 0 0; font-weight: 600;">13 GEL</p>
          </div>
        </div>

        <!-- Corn Bread -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/nrTLnKPJ/temp-Imagekr-CBLj.avif" alt="Corn Bread" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Corn Bread</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">სიმინდის პური</p>
            <p style="margin: 8px 0 0; font-weight: 600;">8 GEL</p>
          </div>
        </div>

        <!-- Green Salad -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/SRZmBSnQ/temp-Image-SKWb-EP.avif" alt="Green Salad" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Green Salad</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">მწვანე სალათი</p>
            <p style="margin: 8px 0 0; font-weight: 600;">15 GEL</p>
          </div>
        </div>

        <!-- Eggplant with walnuts -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/mrXfZXbV/temp-Imagejy8hj-K.avif" alt="Eggplant with walnuts" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Eggplant with walnuts</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">ბადრიჯანი ნიგვზით</p>
            <p style="margin: 8px 0 0; font-weight: 600;">15 GEL</p>
          </div>
        </div>

        <!-- Cucumber and Guda cheese -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/85X13kJp/temp-Image-Fd12-Fh.avif" alt="Cucumber and Guda cheese" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Cucumber and Guda cheese</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">კიტრი და გუდის ყველი</p>
            <p style="margin: 8px 0 0; font-weight: 600;">17 GEL</p>
          </div>
        </div>

        <!-- Khachapuri on Pan -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/FR3Mb9yC/temp-Image-TWZSBw.avif" alt="Khachapuri on Pan" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Khachapuri on Pan</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">ხაჭაპური ტაფაზე</p>
            <p style="margin: 8px 0 0; font-weight: 600;">17 GEL</p>
          </div>
        </div>

        <!-- Lobiani -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/T1yWN4Ps/temp-Image-OFo-Rwi.avif" alt="Lobiani" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Lobiani</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">ლობიანი</p>
            <p style="margin: 8px 0 0; font-weight: 600;">12 GEL</p>
          </div>
        </div>

        <!-- Chichen in walnuts sauce -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.imgur.com/0vnzZ6R.png" alt="Chichen in walnuts sauce" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Chichen in walnuts sauce</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">წიწილა ბაჟეში</p>
            <p style="margin: 8px 0 0; font-weight: 600;">22 GEL</p>
          </div>
        </div>

        <!-- Shkmeruli - chicken in garlic sauce -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/2jwzgwWc/temp-Image-Rb-J08-I.avif" alt="Shkmeruli - chicken in garlic sauce" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Shkmeruli - chicken in garlic sauce</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">შქმერული</p>
            <p style="margin: 8px 0 0; font-weight: 600;">25 GEL</p>
          </div>
        </div>

        <!-- Kharcho - beef in walnuts sauce with Elarji -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/CKxhhfVC/temp-Image-Jn-XKKa.avif" alt="Kharcho - beef in walnuts sauce with Elarji" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Kharcho - beef in walnuts sauce with Elarji</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">ხარჩო ელარჯით</p>
            <p style="margin: 8px 0 0; font-weight: 600;">29 GEL</p>
          </div>
        </div>

        <!-- Kupati - sausage -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/LsnDFNhz/temp-Image-Cfqeog.avif" alt="Kupati - sausage" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Kupati - sausage</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">კუპატი</p>
            <p style="margin: 8px 0 0; font-weight: 600;">35 GEL</p>
          </div>
        </div>

        <!-- Slider - mini burger -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.imgur.com/0vnzZ6R.png" alt="Slider - mini burger" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Slider - mini burger</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">სლაიდერი (მინი ბურგერი)</p>
            <p style="margin: 8px 0 0; font-weight: 600;">25 GEL</p>
          </div>
        </div>

        <!-- Kutaisi Kebab -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.imgur.com/0vnzZ6R.png" alt="Kutaisi Kebab" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Kutaisi Kebab</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">ქუთაისური ქაბაბი</p>
            <p style="margin: 8px 0 0; font-weight: 600;">22 GEL</p>
          </div>
        </div>

        <!-- Ajaphsandali -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.imgur.com/0vnzZ6R.png" alt="Ajaphsandali" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Ajaphsandali</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">აჯაფსანდალი</p>
            <p style="margin: 8px 0 0; font-weight: 600;">18 GEL</p>
          </div>
        </div>

        <!-- Avocado toast -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.imgur.com/0vnzZ6R.png" alt="Avocado toast" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Avocado toast</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">ავოკადოს ტოსტი</p>
            <p style="margin: 8px 0 0; font-weight: 600;">22 GEL</p>
          </div>
        </div>

        <!-- Pork Ribs (450g) -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.imgur.com/0vnzZ6R.png" alt="Pork Ribs (450g)" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Pork Ribs (450g)</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">ნეკნები (450გრ)</p>
            <p style="margin: 8px 0 0; font-weight: 600;">30 GEL</p>
          </div>
        </div>

        <!-- Classic Georgian Barbecue -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.imgur.com/0vnzZ6R.png" alt="Classic Georgian Barbecue" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Classic Georgian Barbecue</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">მწვადი კლასიკურად</p>
            <p style="margin: 8px 0 0; font-weight: 600;">20 GEL</p>
          </div>
        </div>

        <!-- Quail -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.imgur.com/0vnzZ6R.png" alt="Quail" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Quail</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">მწყერი</p>
            <p style="margin: 8px 0 0; font-weight: 600;">29 GEL</p>
          </div>
        </div>

        <!-- Loin barbecue -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.imgur.com/0vnzZ6R.png" alt="Loin barbecue" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Loin barbecue</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">ჩალაღაჯის მწვადი</p>
            <p style="margin: 8px 0 0; font-weight: 600;">22 GEL</p>
          </div>
        </div>

        <!-- Kebab (veal, lamb) -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.imgur.com/0vnzZ6R.png" alt="Kebab (veal, lamb)" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Kebab (veal, lamb)</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">ქაბაბი (ხბო, ცხვარი)</p>
            <p style="margin: 8px 0 0; font-weight: 600;">22 GEL</p>
          </div>
        </div>

        <!-- Syrniki -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.imgur.com/0vnzZ6R.png" alt="Syrniki" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Syrniki</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">სირნიკები</p>
            <p style="margin: 8px 0 0; font-weight: 600;">17 GEL</p>
          </div>
        </div>

        <!-- Chicken in walnuts sauce -->
        <div class="menu-item" style="display: flex; align-items: center; background-color: #2a2a2a; padding: 15px; border-radius: 10px;">
          <img src="https://i.postimg.cc/m2HmtdSV/temp-Image-Mnf-Ji7.avif" alt="Chicken in walnuts sauce" style="width: 100px; height: 100px; object-fit: cover; border-radius: 8px; margin-right: 16px;">
          <div class="menu-item-details">
            <h4 style="margin: 0; font-size: 16px; font-weight: 500;">Chicken in walnuts sauce</h4>
            <p style="margin: 4px 0 0; font-size: 14px; color: #ccc;">წიწილა ბაჟეში</p>
            <p style="margin: 8px 0 0; font-weight: 600;">22 GEL</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Reviews Modal/Section -->
    <div id="reviewsModal" class="reviews-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(11,28,63,0.98); z-index:9999; align-items:center; justify-content:center;">
      <div style="background:#1f2a48; border-radius:16px; max-width:500px; width:90vw; margin:auto; padding:2rem; color:white; position:relative;">
        <button onclick="document.getElementById('reviewsModal').style.display='none'" style="position:absolute; top:1rem; right:1rem; background:none; border:none; color:white; font-size:24px; cursor:pointer;">&times;</button>
        <h3 style="margin-top:0;">Customer Reviews</h3>
        <div id="reviewsList">
          <div style="margin-bottom:1rem; border-bottom:1px solid #333; padding-bottom:1rem;">
            <strong>Anna K.</strong> <span style="color:#FFD700;">★★★★★</span><br>
            "Amazing food and atmosphere!"
          </div>
          <div style="margin-bottom:1rem; border-bottom:1px solid #333; padding-bottom:1rem;">
            <strong>Giorgi T.</strong> <span style="color:#FFD700;">★★★★☆</span><br>
            "Great wine selection. Will visit again."
          </div>
        </div>
        <div style="margin-top:1.5rem;">
          <h4 style="margin-bottom:0.5rem;">Leave a Review</h4>
          <textarea id="newReviewText" style="width:100%; border-radius:8px; border:none; padding:0.5rem; min-height:60px;"></textarea>
          <button onclick="leaveReview()" style="margin-top:0.5rem; background:#DC2626; color:white; border:none; border-radius:8px; padding:10px 16px; font-size:15px; font-weight:600; cursor:pointer; width:100%;">Submit Review</button>
        </div>
      </div>
    </div>
    <script>
      // New trigger for reviews
      document.getElementById('reviewsTabTrigger').onclick = function() {
        document.getElementById('reviewsModal').style.display = 'flex';
      };

      // New trigger for booking modal inside restaurant detail
      document.getElementById('restaurantBookingTrigger').onclick = function() {
          document.getElementById('bookingModal').style.display = 'block';
          document.getElementById('modalOverlay').style.display = 'block';
          document.body.style.overflow = 'hidden';
      };

      function leaveReview() {
        var text = document.getElementById('newReviewText').value.trim();
        if(text) {
          var reviewsList = document.getElementById('reviewsList');
          var div = document.createElement('div');
          div.style.marginBottom = '1rem';
          div.style.borderBottom = '1px solid #333';
          div.style.paddingBottom = '1rem';
          div.innerHTML = '<strong>You</strong> <span style="color:#FFD700;">★★★★★</span><br>' + text;
          reviewsList.prepend(div);
          document.getElementById('newReviewText').value = '';
        }
      }
    </script>

    <script>
      function initializeHonoreSlider() {
        const sliderWrapper = document.querySelector('#restaurantDetail .honore-slider-wrapper');
        const slides = document.querySelectorAll('#restaurantDetail .honore-slide');
        const prevBtn = document.querySelector('#restaurantDetail .honore-prev');
        const nextBtn = document.querySelector('#restaurantDetail .honore-next');
        
        if (!sliderWrapper || !prevBtn || !nextBtn || slides.length === 0) {
          return;
        }

        let currentIndex = 0;
        const totalSlides = slides.length;

        function updateSlider() {
          sliderWrapper.style.transform = `translateX(-${currentIndex * 100}%)`;
        }

        prevBtn.addEventListener('click', function() {
          currentIndex = (currentIndex > 0) ? currentIndex - 1 : totalSlides - 1;
          updateSlider();
        });

        nextBtn.addEventListener('click', function() {
          currentIndex = (currentIndex < totalSlides - 1) ? currentIndex + 1 : 0;
          updateSlider();
        });
      }
    </script>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const bookingTrigger = document.getElementById('bookingTrigger');
    const bookingModal = document.getElementById('bookingModal');
    const modalOverlay = document.getElementById('modalOverlay');
    const partySizes = document.getElementById('partySizes');
    const dateSelect = document.getElementById('dateSelect');
    const timeSelect = document.getElementById('timeSelect');
    const bookingDone = document.getElementById('bookingDone');
    const bookingLabel = document.getElementById('bookingLabel');
    
    let selectedPartySize = 2;
    let selectedDate = new Date();
    let selectedTime = '19:00';

    // Generate party size buttons
    for (let i = 1; i <= 20; i++) {
      const btn = document.createElement('button');
      btn.className = `booking-modal__party-size ${i === 2 ? 'booking-modal__party-size--selected' : ''}`;
      btn.textContent = i;
      btn.onclick = () => {
        document.querySelector('.booking-modal__party-size--selected')?.classList.remove('booking-modal__party-size--selected');
        btn.classList.add('booking-modal__party-size--selected');
        selectedPartySize = i;
      };
      partySizes.appendChild(btn);
    }

    // Generate date options (90 days)
    for (let i = 0; i < 90; i++) {
      const date = new Date();
      date.setDate(date.getDate() + i);
      const option = document.createElement('option');
      option.value = date.toISOString().split('T')[0];
      option.textContent = date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
      dateSelect.appendChild(option);
    }

    // Generate time options (30-minute intervals)
    for (let hour = 11; hour < 24; hour++) {
      for (let minute of ['00', '30']) {
        const time = `${hour}:${minute}`;
        const option = document.createElement('option');
        option.value = time;
        option.textContent = new Date(`2000-01-01T${time}`).toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
        timeSelect.appendChild(option);
      }
    }

    // Show modal
    bookingTrigger.onclick = () => {
      bookingModal.style.display = 'block';
      modalOverlay.style.display = 'block';
      document.body.style.overflow = 'hidden';
    };

    // Close modal
    const closeModal = () => {
      bookingModal.style.display = 'none';
      modalOverlay.style.display = 'none';
      document.body.style.overflow = '';
    };

    // Update booking and close modal
    bookingDone.onclick = () => {
      const date = new Date(dateSelect.value);
      const formattedDate = date.toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
      const formattedTime = new Date(`2000-01-01T${timeSelect.value}`).toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
      bookingLabel.textContent = `${selectedPartySize} • ${formattedTime} ${formattedDate}`;
      closeModal();
    };

    // Close on overlay click or Escape key
    modalOverlay.onclick = closeModal;
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeModal();
    });

    // Trap focus in modal
    bookingModal.addEventListener('keydown', (e) => {
      if (e.key === 'Tab') {
        const focusableElements = bookingModal.querySelectorAll('button, select, input');
        const firstElement = focusableElements[0];
        const lastElement = focusableElements[focusableElements.length - 1];

        if (e.shiftKey && document.activeElement === firstElement) {
          e.preventDefault();
          lastElement.focus();
        } else if (!e.shiftKey && document.activeElement === lastElement) {
          e.preventDefault();
          firstElement.focus();
        }
      }
    });

    const loginIcon = document.querySelector('.header__icon--account');
    const loginModal = document.getElementById('loginModal');
    const loginModalClose = document.getElementById('loginModalClose');
    const loginSubmit = document.getElementById('loginSubmit');

    if (loginIcon && loginModal && loginSubmit) {
      loginIcon.addEventListener('click', e => {
        e.preventDefault();
        loginModal.style.display = 'block';
        document.body.style.overflow = 'hidden';
      });

      loginModalClose.addEventListener('click', () => {
        loginModal.style.display = 'none';
        document.body.style.overflow = '';
      });

      loginSubmit.addEventListener('click', () => {
        const name = document.getElementById('loginName').value.trim();
        const phone = document.getElementById('loginPhone').value.trim();
        const code = document.getElementById('countryCode').value;

        if (!name || !phone) {
          alert('Please enter your name and phone number.');
          return;
        }

        alert(`Verification code sent to ${code} ${phone}`);
        loginModal.style.display = 'none';
        document.body.style.overflow = '';
      });

      // Close on escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && loginModal.style.display === 'block') {
          loginModal.style.display = 'none';
          document.body.style.overflow = '';
        }
      });
    }

    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const headerRow = document.querySelector('.header__row');

    if (mobileMenuToggle && headerRow) {
      mobileMenuToggle.addEventListener('click', () => {
        headerRow.style.display = headerRow.style.display === 'none' ? 'flex' : 'none';
      });

      // Handle resize events
      let timeout;
      window.addEventListener('resize', () => {
        clearTimeout(timeout);
        timeout = setTimeout(() => {
          if (window.innerWidth > 768) {
            headerRow.style.display = 'flex';
          }
        }, 250);
      });
    }

    // Search functionality
    const searchButton = document.getElementById('searchButton');
    const searchModal = document.getElementById('searchModal');
    const searchModalClose = document.getElementById('searchModalClose');
    const searchInput = document.getElementById('searchInput');
    const searchResults = document.getElementById('searchResults');

    // Get all restaurant items
    const restaurants = Array.from(document.querySelectorAll('.trending-item')).map(item => ({
      element: item.cloneNode(true),
      name: item.querySelector('.trending-item__title').textContent,
      cuisine: item.querySelector('.trending-item__cuisine').textContent
    }));

    let mapInitialized = false;
    let mapLoadingTimeout;
    const mapLoading = document.getElementById('mapLoading');
    const mapError = document.getElementById('mapError');
    const mapErrorMessage = document.getElementById('mapErrorMessage');
    const retryMapButton = document.getElementById('retryMapButton');

    // Update restaurant coordinates with real locations
    const restaurantLocations = [
      {
        name: "Alubali",
        coordinate: new mapkit.Coordinate(41.7099, 44.7925),
        cuisine: "Authentic Georgian",
        address: "Tbilisi, 8 Shalva Dadiani St"
      },
      {
        name: "Orangery",
        coordinate: new mapkit.Coordinate(41.7193, 44.7828),
        cuisine: "Georgian & European",
        address: "Tbilisi, 1 Freedom Square"
      },
      {
        name: "Coffee Shop Company",
        coordinate: new mapkit.Coordinate(41.7088, 44.7920),
        cuisine: "Austrian & Eastern European",
        address: "Tbilisi, 29 Rustaveli Ave"
      },
      {
        name: "Paul",
        coordinate: new mapkit.Coordinate(41.7182, 44.7459),
        cuisine: "French Inspired",
        address: "Tbilisi, 3 Bambis Rigi"
      },
      {
        name: "8000 Vintages",
        coordinate: new mapkit.Coordinate(41.6941, 44.8013),
        cuisine: "Wine Bar & Gourmet Bords",
        address: "Tbilisi, 26 Sulkhan Tsintsadze St"
      },
      {
        name: "Khedi",
        coordinate: new mapkit.Coordinate(41.7182, 44.7859),
        cuisine: "Georgian & European",
        address: "Tbilisi, 2 D. Aghmashenebeli Ave"
      }
    ];

    async function initializeMapWithRetry(retryCount = 0) {
      const maxRetries = 3;
      mapError.style.display = 'none';
      mapLoading.style.display = 'flex';

      try {
        if (mapLoadingTimeout) {
          clearTimeout(mapLoadingTimeout);
        }

        mapLoadingTimeout = setTimeout(() => {
          throw new Error('Map initialization timed out');
        }, 10000);

        // Get token from our endpoint
        const tokenResponse = await fetch('/mapkit-token');
        if (!tokenResponse.ok) {
          throw new Error('Failed to get MapKit JS token');
        }
        const token = await tokenResponse.text();

        // Initialize MapKit JS
        mapkit.init({
          authorizationCallback: done => done(token),
          language: "en"
        });

        // Get user's location
        let userLocation;
        try {
          const position = await getUserLocation();
          userLocation = new mapkit.Coordinate(
            position.coords.latitude,
            position.coords.longitude
          );
        } catch (error) {
          console.warn('Geolocation failed:', error);
          userLocation = new mapkit.Coordinate(41.7151, 44.8271); // Tbilisi center
        }

        // Initialize map
        map = new mapkit.Map('searchMap', {
          center: userLocation,
          zoom: 13,
          showsUserLocation: true,
          showsUserLocationControl: true,
          showsZoomControl: true,
          showsScale: mapkit.FeatureVisibility.Visible,
          colorScheme: mapkit.Map.ColorSchemes.Dark
        });

        // Add custom map controls
        addMapControls();
        
        // Add restaurant markers
        await addRestaurantMarkers();

        mapInitialized = true;
        mapLoading.style.display = 'none';
        clearTimeout(mapLoadingTimeout);

      } catch (error) {
        console.error('Map initialization error:', error);
        
        if (retryCount < maxRetries) {
          setTimeout(() => {
            initializeMapWithRetry(retryCount + 1);
          }, 2000 * (retryCount + 1));
        } else {
          mapLoading.style.display = 'none';
          mapError.style.display = 'block';
          mapErrorMessage.textContent = 'Unable to load the map. Please check your internet connection and try again.';
        }
      }
    }

    function addMapControls() {
      // Add custom controls container
      const controlsContainer = document.createElement('div');
      controlsContainer.className = 'map-controls';
      controlsContainer.style.position = 'absolute';
      controlsContainer.style.top = '10px';
      controlsContainer.style.right = '10px';
      controlsContainer.style.display = 'flex';
      controlsContainer.style.flexDirection = 'column';
      controlsContainer.style.gap = '10px';

      // Add center on user button
      const centerButton = document.createElement('button');
      centerButton.className = 'map-control-button';
      centerButton.innerHTML = '<i class="fas fa-location-arrow"></i>';
      centerButton.title = 'Center on your location';
      centerButton.onclick = () => {
        if (map.userLocation) {
          map.setCenterAnimated(map.userLocation.coordinate, true);
        }
      };

      // Add show all restaurants button
      const showAllButton = document.createElement('button');
      showAllButton.className = 'map-control-button';
      showAllButton.innerHTML = '<i class="fas fa-utensils"></i>';
      showAllButton.title = 'Show all restaurants';
      showAllButton.onclick = () => {
        map.showItems(annotations);
      };

      controlsContainer.appendChild(centerButton);
      controlsContainer.appendChild(showAllButton);
      document.getElementById('searchMap').appendChild(controlsContainer);
    }

    async function addRestaurantMarkers() {
      // Clear existing annotations
      if (annotations.length > 0) {
        map.removeAnnotations(annotations);
        annotations = [];
      }

      // Add restaurant markers
      for (const location of restaurantLocations) {
        const annotation = new mapkit.MarkerAnnotation(location.coordinate, {
          title: location.name,
          subtitle: location.address,
          glyphText: "🍽",
          color: "#ff3b30",
          displayPriority: 1000,
          animates: true,
          selected: false
        });

        // Custom callout
        const callout = document.createElement('div');
        callout.className = 'restaurant-callout';
        callout.innerHTML = `
          <h3>${location.name}</h3>
          <p>${location.cuisine}</p>
          <p>${location.address}</p>
          <button onclick="showRestaurantDetails('${location.name}')">View Details</button>
        `;
        
        annotation.callout = callout;

        // Add click handler
        annotation.addEventListener('select', () => {
          map.setCenterAnimated(location.coordinate);
          
          // Find and highlight restaurant in list
          const restaurantElement = document.querySelector(
            `.trending-item:has(.trending-item__title:contains("${location.name}"))`
          );
          if (restaurantElement) {
            restaurantElement.scrollIntoView({ behavior: 'smooth' });
            restaurantElement.style.backgroundColor = 'rgba(255, 255, 255, 0.1)';
            setTimeout(() => {
              restaurantElement.style.backgroundColor = '';
            }, 2000);
          }
        });

        annotations.push(annotation);
      }

      map.showItems(annotations);
    }

    function getUserLocation() {
      return new Promise((resolve, reject) => {
        if (!navigator.geolocation) {
          reject(new Error('Geolocation is not supported'));
          return;
        }

        const timeout = setTimeout(() => {
          reject(new Error('Getting location timed out'));
        }, 5000);

        navigator.geolocation.getCurrentPosition(
          (position) => {
            clearTimeout(timeout);
            resolve(position);
          },
          (error) => {
            clearTimeout(timeout);
            reject(error);
          },
          {
            enableHighAccuracy: true,
            timeout: 5000,
            maximumAge: 0
          }
        );
      });
    }

    // Update search button click handler
    searchButton.addEventListener('click', () => {
      searchModal.style.display = 'block';
      searchInput.focus();
      
      if (!mapInitialized) {
        initializeMapWithRetry();
      }
    });

    // Add retry button handler
    retryMapButton.addEventListener('click', () => {
      initializeMapWithRetry();
    });

    // Update search input handler with error handling
    searchInput.addEventListener('input', () => {
      if (!mapInitialized) return;

      try {
        const searchTerm = searchInput.value.toLowerCase();

        if (searchTerm.length < 2) {
          map.showItems(annotations);
          return;
        }

        const matchingLocations = restaurantLocations.filter(location =>
          location.name.toLowerCase().includes(searchTerm) ||
          location.cuisine.toLowerCase().includes(searchTerm)
        );

        if (matchingLocations.length > 0) {
          const matchingAnnotations = annotations.filter(annotation =>
            matchingLocations.some(location => location.name === annotation.title)
          );

          map.showItems(matchingAnnotations, {
            animate: true,
            padding: new mapkit.Padding(50, 50, 50, 50)
          });
        }
      } catch (error) {
        console.error('Search error:', error);
        // Show a user-friendly error message if needed
      }
    });
  });

  function openRestaurantDetails(restaurantId) {
    document.getElementById('restaurantDetail').style.display = 'block';
    document.body.style.overflow = 'hidden';
    initializeHonoreSlider(); // Initialize the slider when the modal is opened
  }

  function closeRestaurantDetails() {
    document.getElementById('restaurantDetail').style.display = 'none';
    document.body.style.overflow = '';
  }

  // Close on escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && document.getElementById('restaurantDetail').style.display === 'block') {
      closeRestaurantDetails();
    }
  });

  class LocationManager {
    constructor() {
      this.userLocation = null;
      this.watchId = null;
      this.restaurants = document.querySelectorAll('.trending-item');
      
      // Restaurant coordinates (to be replaced with actual data)
      this.restaurantCoordinates = [
        { lat: 41.7151, lng: 44.8271 }, // El Rinconcito
        { lat: 41.7251, lng: 44.8371 }, // Burguet Town
        { lat: 41.7351, lng: 44.8471 }, // Mandala Crunch
        { lat: 41.7451, lng: 44.8571 }, // Taxi Manhattan
        { lat: 41.7551, lng: 44.8671 }, // La Piazzetta
        { lat: 41.7651, lng: 44.8771 }, // Sushi Garden
        { lat: 41.7751, lng: 44.8871 }, // Bistro 23
        { lat: 41.7851, lng: 44.8971 }, // Verde Mar
        { lat: 41.7951, lng: 44.9071 }, // Casa Luna
        { lat: 41.8051, lng: 44.9171 }  // The Grill House
      ];
      
      this.init();
    }

    init() {
      if ("geolocation" in navigator) {
        // Get initial location
        navigator.geolocation.getCurrentPosition(
          position => this.updateLocation(position),
          error => console.error("Error getting location:", error)
        );

        // Watch for location changes
        this.watchId = navigator.geolocation.watchPosition(
          position => this.updateLocation(position),
          error => console.error("Error watching location:", error)
        );
      }
    }

    updateLocation(position) {
      this.userLocation = {
        lat: position.coords.latitude,
        lng: position.coords.longitude
      };
      this.updateDistances();
    }

    calculateDistance(lat1, lon1, lat2, lon2) {
      const R = 6371; // Earth's radius in kilometers
      const dLat = this.toRad(lat2 - lat1);
      const dLon = this.toRad(lon2 - lon1);
      const a = 
        Math.sin(dLat/2) * Math.sin(dLat/2) +
        Math.cos(this.toRad(lat1)) * Math.cos(this.toRad(lat2)) * 
        Math.sin(dLon/2) * Math.sin(dLon/2);
      const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
      return R * c;
    }

    toRad(value) {
      return value * Math.PI / 180;
    }

    formatDistance(distance) {
      if (distance < 1) {
        return `${Math.round(distance * 1000)} m`;
      }
      return `${distance.toFixed(1)} km`;
    }

    updateDistances() {
      this.restaurants.forEach((restaurant, index) => {
        const distanceElement = restaurant.querySelector('.trending-item__distance span');
        const coords = this.restaurantCoordinates[index];
        
        if (this.userLocation && coords) {
          const distance = this.calculateDistance(
            this.userLocation.lat,
            this.userLocation.lng,
            coords.lat,
            coords.lng
          );
          distanceElement.textContent = this.formatDistance(distance);
        }
      });
    }
  }

  // Initialize location manager when DOM is loaded
  document.addEventListener('DOMContentLoaded', () => {
    new LocationManager();
  });

  document.addEventListener('DOMContentLoaded', () => {
    // Replace with your Mapbox token
    mapboxgl.accessToken = 'pk.eyJ1Ijoibmlhc2lraCIsImEiOiJjbTl6dmxlZm8wa254MmtzaHB5cDh0MTI2In0.Y37tRNJ49izZXszfhVyAXw';

    // Enhanced restaurant data with more details
    const restaurants = [
      {
        name: "Alubali",
        coordinates: [44.790283, 41.704956],
        cuisine: "Authentic Georgian",
        cuisineTypes: ["Georgian"],
        address: "6 Akhvlediani St., Tbilisi 0108",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Orangery",
        coordinates: [44.7506633, 41.7106842],
        cuisine: "Georgian & European",
        cuisineTypes: ["Georgian", "European"],
        address: "13 Mosashvili St., Vake Park, Tbilisi 0162",
        rating: 4.7,
        price: "$$"
      },
      {
        name: "Coffee Shop Company - Mosashvili",
        coordinates: [44.7506633, 41.7106842],
        cuisine: "Austrian & Eastern European",
        cuisineTypes: ["Austrian", "Eastern European"],
        address: "Mosashvili St. 11",
        rating: 4.6,
        price: "$$$"
      },
      {
        name: "Coffee Shop Company - Marjanishvili",
        coordinates: [44.7996, 41.7098],
        cuisine: "Austrian & Eastern European",
        cuisineTypes: ["Austrian", "Eastern European"],
        address: "Marjanishvili 5",
        rating: 4.6,
        price: "$$$"
      },
      {
        name: "8000 Vintages - Vake",
        coordinates: [44.754300, 41.709800],
        cuisine: "Wine Bar & Gourmet Boards",
        cuisineTypes: ["Wine Bar"],
        address: "60 Irakli Abashidze St., Vake",
        rating: 4.9,
        price: "$$"
      },
      {
        name: "8000 Vintages - Tsintsadze",
        coordinates: [44.7600, 41.7245],
        cuisine: "Wine Bar & Gourmet Boards",
        cuisineTypes: ["Wine Bar"],
        address: "26 Sulkhan Tsintsadze Street",
        rating: 4.9,
        price: "$$"
      },
      {
        name: "8000 Vintages - Tabukashvili",
        coordinates: [44.7930, 41.7030],
        cuisine: "Wine Bar & Gourmet Boards",
        cuisineTypes: ["Wine Bar"],
        address: "27 Revaz Tabukashvili Street",
        rating: 4.9,
        price: "$$"
      },
      {
        name: "Paul - Abashidze",
        coordinates: [44.7541, 41.7089],
        cuisine: "French Inspired",
        cuisineTypes: ["French"],
        address: "26 I. Abashidze Street",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Paul - Paliashvili",
        coordinates: [44.7547, 41.7160],
        cuisine: "French Inspired",
        cuisineTypes: ["French"],
        address: "87/89 Paliashvili Street",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Paul - Kazbegi",
        coordinates: [44.7660, 41.7240],
        cuisine: "French Inspired",
        cuisineTypes: ["French"],
        address: "15 Aleksandre Kazbegi Avenue",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Paul - Tabidze",
        coordinates: [44.8010, 41.6935],
        cuisine: "French Inspired",
        cuisineTypes: ["French"],
        address: "3/5 G. Tabidze Street",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Paul - Ramishvili",
        coordinates: [44.7590, 41.7100],
        cuisine: "French Inspired",
        cuisineTypes: ["French"],
        address: "37 Nino Ramishvili Street",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Strada - Marjanishvili",
        coordinates: [44.7990, 41.7075],
        cuisine: "Contemporary American & Asian",
        cuisineTypes: ["American", "Asian"],
        address: "5 Marjanishvili Street",
        rating: 4.7,
        price: "$$$"
      },
      {
        name: "Strada - Euli",
        coordinates: [44.7500, 41.7250],
        cuisine: "Contemporary American & Asian",
        cuisineTypes: ["American", "Asian"],
        address: "7 Sandro Euli Street",
        rating: 4.7,
        price: "$$$"
      },
      {
        name: "Strada - Mosashvili",
        coordinates: [44.7561, 41.7094],
        cuisine: "Contemporary American & Asian",
        cuisineTypes: ["American", "Asian"],
        address: "11 Mosashvili Street, Vake District",
        rating: 4.7,
        price: "$$$"
      },
      {
        name: "Canape - Abashidze",
        coordinates: [44.7545, 41.7073],
        cuisine: "Georgian & European",
        cuisineTypes: ["Georgian", "European"],
        address: "14 Irakli Abashidze Street",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Canape - Abano",
        coordinates: [44.8089, 41.6883],
        cuisine: "Georgian & European",
        cuisineTypes: ["Georgian", "European"],
        address: "15/6 Abano Street",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Canape - Kazbegi",
        coordinates: [44.7666, 41.7265],
        cuisine: "Georgian & European",
        cuisineTypes: ["Georgian", "European"],
        address: "7 Aleksandre Kazbegi Avenue",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Canape - Aghmashenebeli",
        coordinates: [44.7990, 41.7090],
        cuisine: "Georgian & European",
        cuisineTypes: ["Georgian", "European"],
        address: "112 Davit Aghmashenebeli Avenue",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Khedi",
        coordinates: [44.8170, 41.6900],
        cuisine: "Georgian & European",
        cuisineTypes: ["Georgian", "European"],
        address: "24 Ketevan Dedofali Avenue",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Tsiskvili - Gamsakhurdia",
        coordinates: [44.7793, 41.7172],
        cuisine: "Authentic Georgian",
        cuisineTypes: ["Georgian"],
        address: "80 Zviad Gamsakhurdia Right Bank",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Tsiskvili - Location 2",
        coordinates: [44.7510, 41.7030],
        cuisine: "Authentic Georgian",
        cuisineTypes: ["Georgian"],
        address: "Tbilisi",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Tsiskvili - Location 3",
        coordinates: [44.7350, 41.6830],
        cuisine: "Authentic Georgian",
        cuisineTypes: ["Georgian"],
        address: "Tbilisi",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Tsiskvili - Beliashvili",
        coordinates: [44.7825, 41.7401],
        cuisine: "Authentic Georgian",
        cuisineTypes: ["Georgian"],
        address: "99 Beliashvili Street",
        rating: 4.8,
        price: "$$$$"
      },
      {
        name: "Rigi",
        coordinates: [44.7960, 41.7070],
        cuisine: "Old Georgian Gastronomic Douqan",
        cuisineTypes: ["Georgian"],
        address: "24/24 Lev Tolstois Street",
        rating: 4.8,
        price: "$$$$"
      }
    ];

    let map;
    let directions;
    const searchButton = document.getElementById('searchButton');
    const searchModal = document.getElementById('searchModal');
    const searchModalClose = document.getElementById('searchModalClose');
    const cuisineFilter = document.getElementById('cuisineFilter');
    const priceFilter = document.getElementById('priceFilter');
    const ratingFilter = document.getElementById('ratingFilter');
    const distanceFilter = document.getElementById('distanceFilter');

    function initializeMap() {
      // Initialize map with a more colorful style
      map = new mapboxgl.Map({
        container: 'searchMap',
        style: 'mapbox://styles/mapbox/navigation-night-v1',
        center: [44.7925, 41.7099], // Center on Tbilisi
        zoom: 12
      });

      // Add navigation controls
      map.addControl(new mapboxgl.NavigationControl());

      // Add geolocation control
      const geolocate = new mapboxgl.GeolocateControl({
        positionOptions: { enableHighAccuracy: true },
        trackUserLocation: true,
        showUserHeading: true
      });
      map.addControl(geolocate);

      // Wait for map to load before adding markers
      map.on('load', () => {
        // Add restaurant markers
        restaurants.forEach(restaurant => {
          // Get the image URL based on restaurant name
          const imageUrl = getRestaurantImage(restaurant.name);
          
          // Create popup
          const popup = new mapboxgl.Popup({ offset: 25 }).setHTML(`
            <div class="restaurant-popup">
              <div class="restaurant-popup__content">
                <div class="restaurant-popup__image-container">
                  <img src="{{ restaurant.image }}" alt="{{ restaurant.name }}" class="restaurant-popup__image">
                </div>
                <div class="restaurant-popup__info">
                  <h3>{{ restaurant.name }}</h3>
                  <p>{{ restaurant.cuisine }}</p>
                  <p>{{ restaurant.address }}</p>
                </div>
              </div>
              <div class="restaurant-popup__details">
                <p>Rating: {{ restaurant.rating }} <i class="fas fa-star"></i> • {{ restaurant.price }}</p>
              </div>
              <button class="restaurant-popup__button" onclick="bookRestaurant('{{ restaurant.name }}')">
                Book Now
              </button>
            </div>
          `);

          // Create marker
          const marker = new mapboxgl.Marker({
            color: '#ff3b30'
          })
            .setLngLat(restaurant.coordinates) // coordinates are already in [longitude, latitude] format
            .setPopup(popup)
            .addTo(map);

          // Store marker reference
          if (!map.markers) map.markers = [];
          map.markers.push(marker);

          // Add click event
          marker.getElement().addEventListener('click', () => {
            highlightRestaurantInList(restaurant.name);
          });
        });

        // Fit map to show all markers
        const bounds = new mapboxgl.LngLatBounds();
        restaurants.forEach(restaurant => {
          bounds.extend(restaurant.coordinates);
        });
        map.fitBounds(bounds, { padding: 50 });

        // Trigger geolocation
        geolocate.trigger();
      });

      // Initialize filters
      initializeFilters();
    }

    function initializeFilters() {
      const filters = [cuisineFilter, priceFilter, ratingFilter, distanceFilter];
      
      filters.forEach(filter => {
        filter.addEventListener('change', () => {
          filterRestaurants();
        });
      });
    }

    function filterRestaurants() {
      const selectedCuisine = cuisineFilter.value;
      const selectedPrice = priceFilter.value;
      const selectedRating = parseFloat(ratingFilter.value) || 0;
      const selectedDistance = parseFloat(distanceFilter.value);

      // Get user's current location from the map
      const userLocation = map.userLocation ? 
        { lat: map.userLocation.coords.latitude, lng: map.userLocation.coords.longitude } :
        { lat: 41.7151, lng: 44.8271 }; // Default to Tbilisi center if location not available

      const filteredRestaurants = restaurants.filter(restaurant => {
        const matchesCuisine = !selectedCuisine || restaurant.cuisineTypes.includes(selectedCuisine);
        const matchesPrice = !selectedPrice || restaurant.price === selectedPrice;
        const matchesRating = restaurant.rating >= selectedRating;
        
        // Calculate distance from user
        const distance = calculateDistance(
          userLocation.lat,
          userLocation.lng,
          restaurant.coordinates[1],
          restaurant.coordinates[0]
        );

        const matchesDistance = !selectedDistance || distance <= selectedDistance;

        return matchesCuisine && matchesPrice && matchesRating && matchesDistance;
      });

      // Update map markers
      updateMapMarkers(filteredRestaurants);

      // Update restaurant list visibility
      updateRestaurantList(filteredRestaurants);
    }

    function updateMapMarkers(filteredRestaurants) {
      // Remove existing markers
      if (map.markers) {
        map.markers.forEach(marker => marker.remove());
      }
      map.markers = [];

      // Add filtered markers
      filteredRestaurants.forEach(restaurant => {
        // Get the image URL based on restaurant name
        const imageUrl = getRestaurantImage(restaurant.name);
        
        const popup = new mapboxgl.Popup({ offset: 25 }).setHTML(`
          <div class="restaurant-popup">
            <div class="restaurant-popup__content">
              <div class="restaurant-popup__image-container">
                <img src="{{ restaurant.image }}" alt="{{ restaurant.name }}" class="restaurant-popup__image">
              </div>
              <div class="restaurant-popup__info">
                <h3>{{ restaurant.name }}</h3>
                <p>{{ restaurant.cuisine }}</p>
                <p>{{ restaurant.address }}</p>
              </div>
            </div>
            <div class="restaurant-popup__details">
              <p>Rating: {{ restaurant.rating }} <i class="fas fa-star"></i> • {{ restaurant.price }}</p>
            </div>
            <button class="restaurant-popup__button" onclick="bookRestaurant('{{ restaurant.name }}')">
              Book Now
            </button>
          </div>
        `);

        const marker = new mapboxgl.Marker({
          color: '#ff3b30'
        })
          .setLngLat(restaurant.coordinates)
          .setPopup(popup)
          .addTo(map);
        
        map.markers.push(marker);
      });

      // Fit map to show filtered markers
      if (filteredRestaurants.length > 0) {
        const bounds = new mapboxgl.LngLatBounds();
        filteredRestaurants.forEach(restaurant => {
          bounds.extend(restaurant.coordinates);
        });
        map.fitBounds(bounds, { padding: 50 });
      }
    }

    function highlightRestaurantInList(restaurantName) {
      const restaurantElement = document.querySelector(
        `.trending-item:has(.trending-item__title:contains("${restaurantName}"))`
      );
      if (restaurantElement) {
        restaurantElement.scrollIntoView({ behavior: 'smooth' });
        restaurantElement.style.backgroundColor = 'rgba(255, 255, 255, 0.1)';
        setTimeout(() => {
          restaurantElement.style.backgroundColor = '';
        }, 2000);
      }
    }

    // Event listeners
    searchButton.addEventListener('click', () => {
      searchModal.style.display = 'block';
      if (!map) {
        initializeMap();
      }
    });

    searchModalClose.addEventListener('click', () => {
      searchModal.style.display = 'none';
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && searchModal.style.display === 'block') {
        searchModal.style.display = 'none';
      }
    });

    searchModal.addEventListener('click', (e) => {
      if (e.target === searchModal) {
        searchModal.style.display = 'none';
      }
    });
  });

  // Update cuisine filter options based on all available cuisines
  document.addEventListener('DOMContentLoaded', () => {
    const cuisineFilter = document.getElementById('cuisineFilter');
    const uniqueCuisines = [...new Set(restaurants.flatMap(r => r.cuisineTypes))].sort();
    
    cuisineFilter.innerHTML = '<option value="">All Cuisines</option>' +
      uniqueCuisines.map(cuisine => 
        `<option value="${cuisine}">${cuisine}</option>`
      ).join('');
  });

  function calculateDistance(lat1, lon1, lat2, lon2) {
    const R = 6371; // Earth's radius in kilometers
    const dLat = toRad(lat2 - lat1);
    const dLon = toRad(lon2 - lon1);
    const a = 
      Math.sin(dLat/2) * Math.sin(dLat/2) +
      Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) * 
      Math.sin(dLon/2) * Math.sin(dLon/2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    return R * c;
  }

  function toRad(value) {
    return value * Math.PI / 180;
  }

  function updateRestaurantList(filteredRestaurants) {
    const restaurantElements = document.querySelectorAll('.trending-item');
    
    restaurantElements.forEach(element => {
      const name = element.querySelector('.trending-item__title').textContent;
      const isVisible = filteredRestaurants.some(r => r.name === name);
      element.style.display = isVisible ? 'flex' : 'none';
    });
  }

  // ... existing code ...

  // Update the event listeners for filters
  document.addEventListener('DOMContentLoaded', () => {
    const filters = [cuisineFilter, priceFilter, ratingFilter, distanceFilter];
    
    filters.forEach(filter => {
      filter.addEventListener('change', () => {
        filterRestaurants();
      });
    });

    // Initialize geolocation when map loads
    map.on('load', () => {
      const geolocate = new mapboxgl.GeolocateControl({
        positionOptions: { enableHighAccuracy: true },
        trackUserLocation: true,
        showUserHeading: true
      });
      map.addControl(geolocate);

      // Trigger geolocation on map load
      geolocate.trigger();
    });
  });

  // ... existing code ...

  // Helper function to get restaurant image URL
  function getRestaurantImage(restaurantName) {
    const imageMap = {
      'Alubali': 'https://imgur.com/W5x0iFf.png',
      'Orangery': 'https://imgur.com/iycCzV0.png',
      'Coffee Shop Company': 'https://imgur.com/ZK08ntt.png',
      'Paul': 'https://imgur.com/npKcyus.png',
      'Strada': 'https://imgur.com/ffNFiWL.png',
      '8000 Vintages': 'https://imgur.com/nhIwbAE.png',
      'Canape': 'https://imgur.com/A2XSgKc.png',
      'Khedi': 'https://imgur.com/vKzlLfm.png',
      'Tsiskvili': 'https://imgur.com/JNsWf7e.png',
      'Rigi': 'https://imgur.com/Z4Mjh6u.png'
    };

    // Extract base name for restaurants with multiple locations
    const baseName = restaurantName.split(' - ')[0];
    return imageMap[baseName] || 'https://imgur.com/placeholder.png';
  }

  // Add favorites management
  let userFavorites = [];
  let isAuthenticated = false;

  // Function to toggle favorite
  async function toggleFavorite(restaurantId, button) {
    if (!isAuthenticated) {
      document.querySelector('.login-modal').style.display = 'block';
      return;
    }

    const isFavorited = userFavorites.includes(restaurantId);
    
    // Optimistic UI update
    if (isFavorited) {
      userFavorites = userFavorites.filter(id => id !== restaurantId);
    } else {
      userFavorites.push(restaurantId);
    }
    
    // Update UI
    updateFavoriteButton(button, !isFavorited);
    
    try {
      // API call
      const response = await fetch(`/api/favorites/${isFavorited ? 'remove' : 'add'}`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ restaurantId }),
      });
      
      if (!response.ok) {
        throw new Error('Failed to update favorites');
      }
    } catch (error) {
      console.error('Error updating favorites:', error);
      // Revert optimistic update on error
      if (isFavorited) {
        userFavorites.push(restaurantId);
      } else {
        userFavorites = userFavorites.filter(id => id !== restaurantId);
      }
      updateFavoriteButton(button, isFavorited);
    }
  }

  // Function to update favorite button UI
  function updateFavoriteButton(button, isFavorited) {
    button.setAttribute('data-favorited', isFavorited);
    button.innerHTML = `
      <i class="fas fa-bookmark${isFavorited ? '' : '-regular'}"></i>
      <span class="bookmark-tooltip">${isFavorited ? 'Remove from favorites' : 'Save to favorites'}</span>
    `;
  }

  // Update restaurant card template
  function createRestaurantCard(restaurant) {
    const isFavorited = userFavorites.includes(restaurant.id);
    return `
      <div class="restaurant-card">
        <button 
          class="bookmark-button" 
          data-favorited="${isFavorited}"
          onclick="toggleFavorite('{{ restaurant.id }}', this)"
        >
          <i class="fas fa-bookmark${isFavorited ? '' : '-regular' }}"></i>
          <span class="bookmark-tooltip">{% if isFavorited %}Remove from favorites{% else %}Save to favorites{% endif %}</span>
        </button>
        <img class="restaurant-card__image" src="{{ restaurant.image }}" alt="{{ restaurant.name }}">
        <div class="restaurant-card__content">
          <!-- ... existing content ... -->
        </div>
      </div>
    `;
  }

  // Update popup HTML generation
  function getPopupHTML(restaurant) {
    const isFavorited = userFavorites.includes(restaurant.id);
    return `
      <div class="restaurant-popup">
        <button 
          class="bookmark-button" 
          data-favorited="{{ isFavorited }}"
          onclick="toggleFavorite('{{ restaurant.id }}', this)"
        >
          <i class="fas fa-bookmark${isFavorited ? '' : '-regular' }}"></i>
          <span class="bookmark-tooltip">{% if isFavorited %}Remove from favorites{% else %}Save to favorites{% endif %}</span>
        </button>
        <img class="restaurant-popup__image" src="{{ restaurant.image }}" alt="{{ restaurant.name }}" loading="lazy">
        <div class="restaurant-popup__content">
          <h3>{{ restaurant.name }}</h3>
          <p>{{ restaurant.cuisine }}</p>
          <p>{{ restaurant.address }}</p>
          <div class="restaurant-popup__details">
            <span class="rating">
              {{ restaurant.rating }}
            </span>
            <span class="price">{{ restaurant.price }}</span>
          </div>
          <button class="restaurant-popup__button">Book Now</button>
        </div>
      </div>
    `;
  }

  // Initialize favorites when user logs in
  function initializeFavorites(favorites = []) {
    userFavorites = favorites;
    isAuthenticated = true;
    // Update all existing bookmark buttons
    document.querySelectorAll('.bookmark-button').forEach(button => {
      const restaurantId = button.closest('[data-restaurant-id]').dataset.restaurantId;
      updateFavoriteButton(button, userFavorites.includes(restaurantId));
    });
  }

  // ... existing code ...

  // Add cuisine filtering function
  function filterByCuisine(cuisine) {
    // Update UI to show selected cuisine
    document.querySelectorAll('.cuisine-card').forEach(card => {
      card.classList.toggle('selected', card.querySelector('.cuisine-card__title').textContent === cuisine);
    });
    
    // Filter restaurants (you can implement the actual filtering logic)
    console.log(`Filtering by cuisine: ${cuisine}`);
  }

  // Update cuisine carousel scroll handling
  document.querySelector('.cuisine-carousel').addEventListener('wheel', (e) => {
    // Only handle horizontal scroll if:
    // 1. The cursor is directly over the carousel
    // 2. There's horizontal scrolling possible (content wider than container)
    const carousel = e.currentTarget;
    const isScrollable = carousel.scrollWidth > carousel.clientWidth;
    
    if (isScrollable) {
      // Check if we're at the edges
      const isAtLeftEdge = carousel.scrollLeft === 0 && e.deltaY < 0;
      const isAtRightEdge = carousel.scrollLeft >= carousel.scrollWidth - carousel.clientWidth && e.deltaY > 0;
      
      // Only prevent default if we're not at the edges
      if (!isAtLeftEdge && !isAtRightEdge) {
        e.preventDefault();
        carousel.scrollLeft += e.deltaY;
      }
    }
  });

  document.addEventListener('DOMContentLoaded', () => {
    const sliderWrapper = document.querySelector('.honore-slider-wrapper');
    const slides = document.querySelectorAll('.honore-slide');
    const prevBtn = document.querySelector('.honore-prev');
    const nextBtn = document.querySelector('.honore-next');
    let currentIndex = 0;
    const totalSlides = slides.length;

    if (sliderWrapper) {
      function updateSlider() {
        sliderWrapper.style.transform = `translateX(-${currentIndex * 100}%)`;
      }

      prevBtn.addEventListener('click', function() {
        currentIndex = (currentIndex > 0) ? currentIndex - 1 : totalSlides - 1;
        updateSlider();
      });

      nextBtn.addEventListener('click', function() {
        currentIndex = (currentIndex < totalSlides - 1) ? currentIndex + 1 : 0;
        updateSlider();
      });
    }
  });
</script>


<!-- Optimize restaurant images -->
<!--
<div class="restaurant-card" onclick="openRestaurantDetails('honore')">
  <img src="https://i.imgur.com/rII6OSp.png" 
       loading="eager" 
       fetchpriority="high"
       decoding="async" 
       alt="Honoré" 
       class="restaurant-card__image">
  <!-- ... rest of the restaurant card content ... -->
</div>
-->

<!-- Optimize performance with IntersectionObserver -->
<script>
// ... existing code ...
</script>

<!-- Add resource hints -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="dns-prefetch" href="https://fonts.googleapis.com">
<link rel="dns-prefetch" href="https://fonts.gstatic.com">

<script>
// --- IntersectionObserver Lazy Loading for Images ---
document.addEventListener('DOMContentLoaded', function() {
  const lazyImages = [].slice.call(document.querySelectorAll('.restaurant-card__image, .trending-item__image, .cuisine-card__image'));
  if ('IntersectionObserver' in window) {
    let lazyImageObserver = new IntersectionObserver(function(entries, observer) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          let img = entry.target;
          if (img.dataset.src) {
            img.src = img.dataset.src;
            img.removeAttribute('data-src');
          }
          img.setAttribute('loading', 'lazy');
          img.setAttribute('decoding', 'async');
          lazyImageObserver.unobserve(img);
        }
      });
    });
    lazyImages.forEach(function(img) {
      if (img.src) {
        img.dataset.src = img.src;
        img.src = '';
      }
      lazyImageObserver.observe(img);
    });
  }
});

// --- Virtualize Trending List ---
document.addEventListener('DOMContentLoaded', function() {
  const trendingList = document.querySelector('.trending-list');
  if (!trendingList) return;
  const allItems = Array.from(trendingList.children);
  const VISIBLE_COUNT = 10;
  let start = 0;
  let end = VISIBLE_COUNT;

  function renderTrending() {
    trendingList.innerHTML = '';
    for (let i = start; i < end && i < allItems.length; i++) {
      trendingList.appendChild(allItems[i]);
    }
  }

  function onScroll() {
    const rect = trendingList.getBoundingClientRect();
    if (window.innerHeight - rect.bottom > -200 && end < allItems.length) {
      end = Math.min(end + VISIBLE_COUNT, allItems.length);
      renderTrending();
    }
  }

  renderTrending();
  window.addEventListener('scroll', onScroll, { passive: true });
});

// --- Throttle Distance Updates in LocationManager ---
class LocationManager {
  constructor() {
    this.userLocation = null;
    this.watchId = null;
    this.restaurants = document.querySelectorAll('.trending-item');
    this.restaurantCoordinates = [
      { lat: 41.7151, lng: 44.8271 },
      { lat: 41.7251, lng: 44.8371 },
      { lat: 41.7351, lng: 44.8471 },
      { lat: 41.7451, lng: 44.8571 },
      { lat: 41.7551, lng: 44.8671 },
      { lat: 41.7651, lng: 44.8771 },
      { lat: 41.7751, lng: 44.8871 },
      { lat: 41.7851, lng: 44.8971 },
      { lat: 41.7951, lng: 44.9071 },
      { lat: 41.8051, lng: 44.9171 }
    ];
    this.updateDistancesThrottled = this.throttle(this.updateDistances.bind(this), 200);
    this.init();
  }
  throttle(func, limit) {
    let inThrottle;
    return function() {
      const args = arguments;
      const context = this;
      if (!inThrottle) {
        func.apply(context, args);
        inThrottle = true;
        setTimeout(() => inThrottle = false, limit);
      }
    };
  }
  init() {
    if ("geolocation" in navigator) {
      navigator.geolocation.getCurrentPosition(
        position => this.updateLocation(position),
        error => console.error("Error getting location:", error)
      );
      this.watchId = navigator.geolocation.watchPosition(
        position => this.updateLocation(position),
        error => console.error("Error watching location:", error)
      );
    }
  }
  updateLocation(position) {
    this.userLocation = {
      lat: position.coords.latitude,
      lng: position.coords.longitude
    };
    this.updateDistancesThrottled();
  }
  // ... rest of LocationManager ...
}
// ... existing code ...
</script>
// ... existing code ...

{% schema %}
{
  "name": "Header Secondary",
  "settings": [],
  "blocks": [],
  "presets": [{ "name": "Default" }]
}
{% endschema %}
