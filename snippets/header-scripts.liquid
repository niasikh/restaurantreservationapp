<script>
// Add debounced scroll handler
function debounce(func, wait) {
  let timeout;
  return function executedFunction(...args) {
    const later = () => {
      clearTimeout(timeout);
      func(...args);
    };
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };
}

// Optimize scroll performance
document.addEventListener('DOMContentLoaded', function() {
  const carousel = document.querySelector('.cuisine-carousel');
  if (carousel) {
    carousel.addEventListener('wheel', debounce((e) => {
      const carousel = e.currentTarget;
      const isScrollable = carousel.scrollWidth > carousel.clientWidth;
      
      if (isScrollable) {
        const isAtLeftEdge = carousel.scrollLeft === 0 && e.deltaY < 0;
        const isAtRightEdge = carousel.scrollLeft >= carousel.scrollWidth - carousel.clientWidth && e.deltaY > 0;
        
        if (!isAtLeftEdge && !isAtRightEdge) {
          e.preventDefault();
          carousel.scrollLeft += e.deltaY;
        }
      }
    }, 16)); // Debounce to 60fps
  }
});

// Optimize cuisine filtering
function filterByCuisine(cuisine) {
  requestAnimationFrame(() => {
    document.querySelectorAll('.cuisine-card').forEach(card => {
      card.classList.toggle('selected', card.querySelector('.cuisine-card__title').textContent === cuisine);
    });
    console.log(`Filtering by cuisine: ${cuisine}`);
  });
}

// Booking modal functionality
document.addEventListener('DOMContentLoaded', function() {
  const bookingTrigger = document.getElementById('bookingTrigger');
  const bookingModal = document.getElementById('bookingModal');
  const modalOverlay = document.getElementById('modalOverlay');
  const bookingDone = document.getElementById('bookingDone');
  const partySizes = document.getElementById('partySizes');
  const dateSelect = document.getElementById('dateSelect');
  const timeSelect = document.getElementById('timeSelect');
  const bookingLabel = document.getElementById('bookingLabel');

  // Generate party sizes
  for (let i = 1; i <= 12; i++) {
    const button = document.createElement('button');
    button.className = 'booking-modal__party-size';
    button.textContent = i;
    button.onclick = function() {
      document.querySelectorAll('.booking-modal__party-size').forEach(btn => btn.classList.remove('booking-modal__party-size--selected'));
      this.classList.add('booking-modal__party-size--selected');
    };
    partySizes.appendChild(button);
  }

  // Generate dates for next 30 days
  for (let i = 0; i < 30; i++) {
    const date = new Date();
    date.setDate(date.getDate() + i);
    const option = document.createElement('option');
    option.value = date.toISOString().split('T')[0];
    option.textContent = date.toLocaleDateString('en-US', { 
      weekday: 'short', 
      month: 'short', 
      day: 'numeric' 
    });
    dateSelect.appendChild(option);
  }

  // Show modal
  if (bookingTrigger) {
    bookingTrigger.addEventListener('click', function() {
      bookingModal.style.display = 'block';
      modalOverlay.style.display = 'block';
    });
  }

  // Hide modal
  function hideModal() {
    bookingModal.style.display = 'none';
    modalOverlay.style.display = 'none';
  }

  if (modalOverlay) {
    modalOverlay.addEventListener('click', hideModal);
  }

  if (bookingDone) {
    bookingDone.addEventListener('click', function() {
      const selectedPartySize = document.querySelector('.booking-modal__party-size--selected');
      const selectedDate = dateSelect.value;
      const selectedTime = timeSelect.value;
      
      if (selectedPartySize && selectedDate && selectedTime) {
        const date = new Date(selectedDate);
        const formattedDate = date.toLocaleDateString('en-US', { 
          weekday: 'short', 
          month: 'short', 
          day: 'numeric' 
        });
        bookingLabel.textContent = `${selectedPartySize.textContent} â€¢ ${selectedTime} ${formattedDate}`;
      }
      hideModal();
    });
  }
});

// Login modal functionality
document.addEventListener('DOMContentLoaded', function() {
  const loginModal = document.getElementById('loginModal');
  const loginModalClose = document.getElementById('loginModalClose');
  const loginSubmit = document.getElementById('loginSubmit');

  if (loginModalClose) {
    loginModalClose.addEventListener('click', function() {
      loginModal.style.display = 'none';
    });
  }

  if (loginSubmit) {
    loginSubmit.addEventListener('click', function() {
      const name = document.getElementById('loginName').value;
      const phone = document.getElementById('loginPhone').value;
      const countryCode = document.getElementById('countryCode').value;
      
      if (name && phone) {
        console.log('Login attempt:', { name, phone: countryCode + phone });
        // Add your login logic here
        loginModal.style.display = 'none';
      }
    });
  }
});

// Search modal functionality
document.addEventListener('DOMContentLoaded', function() {
  const searchButton = document.getElementById('searchButton');
  const searchModal = document.getElementById('searchModal');
  const searchModalClose = document.getElementById('searchModalClose');

  if (searchButton) {
    searchButton.addEventListener('click', function() {
      searchModal.style.display = 'block';
    });
  }

  if (searchModalClose) {
    searchModalClose.addEventListener('click', function() {
      searchModal.style.display = 'none';
    });
  }
});

// Mobile menu toggle
document.addEventListener('DOMContentLoaded', function() {
  const mobileMenuToggle = document.getElementById('mobileMenuToggle');
  
  if (mobileMenuToggle) {
    mobileMenuToggle.addEventListener('click', function() {
      // Add your mobile menu logic here
      console.log('Mobile menu toggled');
    });
  }
});
</script> 